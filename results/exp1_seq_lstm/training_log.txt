[19:08:17] ======================================================================
[19:08:17] EXPERIMENT 1: Sequence-based InceptionV3 + LSTM
[19:08:17]   Device:     mps
[19:08:17]   Seq length: 10 spectrograms per sample
[19:08:17]   LSTM:       hidden=128, layers=1
[19:08:17]   pos_weight: n_mdd/n_h (corrected — penalizes missing MDD)
[19:08:17]   Threshold:  optimized on validation set per fold
[19:08:17] ======================================================================
[19:08:17] Loading data...
[19:08:24]   Loaded: (59900, 224, 224, 3), labels=(59900,)
[19:08:24]   Subjects: 40 | LOSO folds: 40
[19:08:24] ======================================================================
[19:08:24] FOLD 1/40 — Test Subject: H_14
[19:08:24] ======================================================================
[19:08:59]   Sequences — Train: 4954, Val: 874, Test: 142
[19:08:59]   Class balance (train): H=1717, MDD=3237 | pos_weight=1.885
[19:08:59]   Data prep: 35.0s
[19:09:00]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[19:09:00]   Starting training...
[19:10:48]   Epoch  1/50 | train=0.8114 | val=0.7308 | 108.8s
[19:12:35]   Epoch  2/50 | train=0.7221 | val=0.6433 | 106.9s
[19:14:26]   Epoch  3/50 | train=0.6805 | val=0.6151 | 110.3s
[19:16:23]   Epoch  4/50 | train=0.6667 | val=0.6437 | 116.8s
[19:18:22]   Epoch  5/50 | train=0.6691 | val=0.6246 | 119.2s
[19:20:23]   Epoch  6/50 | train=0.6534 | val=0.6138 | 121.3s
[19:22:26]   Epoch  7/50 | train=0.6628 | val=0.7454 | 123.0s
[19:24:31]   Epoch  8/50 | train=0.6456 | val=0.6538 | 124.5s
[19:26:39]   Epoch  9/50 | train=0.6361 | val=0.6078 | 128.5s
[19:28:50]   Epoch 10/50 | train=0.6395 | val=0.6099 | 130.4s
[19:30:58]   Epoch 11/50 | train=0.6397 | val=0.5956 | 128.0s
[19:33:06]   Epoch 12/50 | train=0.6235 | val=0.6278 | 128.0s
[19:35:15]   Epoch 13/50 | train=0.6247 | val=0.6204 | 128.9s
[19:37:25]   Epoch 14/50 | train=0.6148 | val=0.6373 | 129.8s
[19:39:34]   Epoch 15/50 | train=0.6168 | val=0.6434 | 129.3s
[19:41:43]   Epoch 16/50 | train=0.6146 | val=0.6712 | 129.2s
[19:43:52]   Epoch 17/50 | train=0.6144 | val=0.5883 | 128.8s
[19:46:00]   Epoch 18/50 | train=0.6098 | val=0.6009 | 127.8s
[19:48:08]   Epoch 19/50 | train=0.6072 | val=0.6002 | 128.0s
[19:50:15]   Epoch 20/50 | train=0.6075 | val=0.5919 | 127.4s
[19:52:22]   Epoch 21/50 | train=0.5981 | val=0.5921 | 127.2s
[19:54:30]   Epoch 22/50 | train=0.5952 | val=0.6397 | 127.8s
[19:56:38]   Epoch 23/50 | train=0.5972 | val=0.6360 | 128.1s
[19:58:46]   Epoch 24/50 | train=0.5934 | val=0.5924 | 127.8s
[20:00:53]   Epoch 25/50 | train=0.5927 | val=0.5943 | 127.0s
[20:03:00]   Epoch 26/50 | train=0.5904 | val=0.5918 | 126.9s
[20:05:07]   Epoch 27/50 | train=0.5907 | val=0.6294 | 127.0s
[20:05:07]   Early stopping at epoch 27
[20:05:24]   Optimal threshold: 0.55 (val F1=0.874)
[20:05:26]   RESULTS: acc=0.669 | f1=0.000 | auc=nan | thresh=0.55
[20:05:26]            Sensitivity(MDD)=0.000 | Specificity(H)=0.669
[20:05:26]   Fold time: 57.0 min
[20:05:28] ======================================================================
[20:05:28] FOLD 2/40 — Test Subject: H_16
[20:05:28] ======================================================================
[20:06:31]   Sequences — Train: 4950, Val: 873, Test: 147
[20:06:31]   Class balance (train): H=1713, MDD=3237 | pos_weight=1.890
[20:06:31]   Data prep: 63.1s
[20:06:31]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[20:06:31]   Starting training...
[20:08:26]   Epoch  1/50 | train=0.8207 | val=0.7801 | 114.5s
[20:10:32]   Epoch  2/50 | train=0.7245 | val=0.6241 | 125.8s
[20:12:43]   Epoch  3/50 | train=0.6588 | val=0.5927 | 130.9s
[20:14:51]   Epoch  4/50 | train=0.6487 | val=0.7357 | 127.8s
[20:16:58]   Epoch  5/50 | train=0.6282 | val=0.6351 | 127.5s
[20:19:06]   Epoch  6/50 | train=0.6306 | val=0.6062 | 127.3s
[20:21:13]   Epoch  7/50 | train=0.6234 | val=0.6113 | 127.3s
[20:23:20]   Epoch  8/50 | train=0.6049 | val=0.5936 | 127.1s
[20:25:27]   Epoch  9/50 | train=0.5954 | val=0.6982 | 126.8s
[20:27:34]   Epoch 10/50 | train=0.5975 | val=0.6453 | 126.9s
[20:29:40]   Epoch 11/50 | train=0.5937 | val=0.5746 | 126.7s
[20:31:47]   Epoch 12/50 | train=0.5874 | val=0.5802 | 126.7s
[20:33:54]   Epoch 13/50 | train=0.5736 | val=0.5971 | 126.6s
[20:36:00]   Epoch 14/50 | train=0.5641 | val=0.5769 | 126.3s
[20:38:06]   Epoch 15/50 | train=0.5834 | val=0.5703 | 126.0s
[20:40:12]   Epoch 16/50 | train=0.5750 | val=0.5670 | 125.4s
[20:42:17]   Epoch 17/50 | train=0.5668 | val=0.5861 | 125.1s
[20:44:22]   Epoch 18/50 | train=0.5773 | val=0.5690 | 125.2s
[20:46:27]   Epoch 19/50 | train=0.5561 | val=0.5845 | 124.8s
[20:48:31]   Epoch 20/50 | train=0.5596 | val=0.5687 | 124.7s
[20:50:36]   Epoch 21/50 | train=0.5625 | val=0.5792 | 124.4s
[20:52:40]   Epoch 22/50 | train=0.5501 | val=0.5664 | 124.4s
[20:54:46]   Epoch 23/50 | train=0.5514 | val=0.5854 | 125.3s
[20:56:50]   Epoch 24/50 | train=0.5469 | val=0.5681 | 123.9s
[20:58:54]   Epoch 25/50 | train=0.5367 | val=0.5885 | 124.2s
[21:00:58]   Epoch 26/50 | train=0.5290 | val=0.5852 | 123.8s
[21:03:02]   Epoch 27/50 | train=0.5271 | val=0.5951 | 124.0s
[21:05:05]   Epoch 28/50 | train=0.5436 | val=0.5741 | 123.9s
[21:07:10]   Epoch 29/50 | train=0.5367 | val=0.5741 | 124.9s
[21:09:16]   Epoch 30/50 | train=0.5220 | val=0.6462 | 125.3s
[21:11:20]   Epoch 31/50 | train=0.5194 | val=0.5777 | 123.9s
[21:13:23]   Epoch 32/50 | train=0.5206 | val=0.5743 | 123.8s
[21:13:23]   Early stopping at epoch 32
[21:13:40]   Optimal threshold: 0.55 (val F1=0.881)
[21:13:43]   RESULTS: acc=0.020 | f1=0.000 | auc=nan | thresh=0.55
[21:13:43]            Sensitivity(MDD)=0.000 | Specificity(H)=0.020
[21:13:43]   Fold time: 68.2 min
[21:13:44] ======================================================================
[21:13:44] FOLD 3/40 — Test Subject: H_19
[21:13:44] ======================================================================
[21:14:49]   Sequences — Train: 4943, Val: 872, Test: 155
[21:14:49]   Class balance (train): H=1706, MDD=3237 | pos_weight=1.897
[21:14:49]   Data prep: 64.3s
[21:14:49]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[21:14:49]   Starting training...
[21:16:49]   Epoch  1/50 | train=0.8292 | val=0.8032 | 120.4s
[21:18:55]   Epoch  2/50 | train=0.7476 | val=0.6733 | 125.3s
[21:21:01]   Epoch  3/50 | train=0.7079 | val=0.7763 | 126.1s
[21:23:05]   Epoch  4/50 | train=0.6822 | val=0.6234 | 123.6s
[21:25:08]   Epoch  5/50 | train=0.6760 | val=0.6866 | 123.6s
[21:27:12]   Epoch  6/50 | train=0.6598 | val=0.6393 | 123.3s
[21:29:15]   Epoch  7/50 | train=0.6599 | val=0.6268 | 123.5s
[21:31:19]   Epoch  8/50 | train=0.6477 | val=0.6573 | 123.3s
[21:33:22]   Epoch  9/50 | train=0.6378 | val=0.6235 | 123.3s
[21:35:25]   Epoch 10/50 | train=0.6508 | val=0.6356 | 123.1s
[21:37:28]   Epoch 11/50 | train=0.6408 | val=0.6212 | 123.2s
[21:39:31]   Epoch 12/50 | train=0.6359 | val=0.6947 | 122.6s
[21:41:33]   Epoch 13/50 | train=0.6374 | val=0.6577 | 122.5s
[21:43:36]   Epoch 14/50 | train=0.6350 | val=0.6008 | 122.6s
[21:45:39]   Epoch 15/50 | train=0.6154 | val=0.6491 | 122.5s
[21:47:41]   Epoch 16/50 | train=0.6218 | val=0.6106 | 122.7s
[21:49:44]   Epoch 17/50 | train=0.6130 | val=0.6508 | 122.8s
[21:51:47]   Epoch 18/50 | train=0.6161 | val=0.6586 | 123.0s
[21:53:50]   Epoch 19/50 | train=0.6158 | val=0.6175 | 123.3s
[21:55:53]   Epoch 20/50 | train=0.6095 | val=0.6165 | 122.8s
[21:58:00]   Epoch 21/50 | train=0.6138 | val=0.6034 | 126.7s
[22:00:06]   Epoch 22/50 | train=0.6092 | val=0.6065 | 126.2s
[22:02:11]   Epoch 23/50 | train=0.6021 | val=0.5984 | 124.6s
[22:04:15]   Epoch 24/50 | train=0.6014 | val=0.6928 | 123.8s
[22:06:19]   Epoch 25/50 | train=0.5949 | val=0.7616 | 124.6s
[22:08:24]   Epoch 26/50 | train=0.6021 | val=0.6177 | 124.5s
[22:10:28]   Epoch 27/50 | train=0.6035 | val=0.5985 | 124.1s
[22:12:31]   Epoch 28/50 | train=0.5812 | val=0.6001 | 123.5s
[22:14:35]   Epoch 29/50 | train=0.5850 | val=0.6020 | 124.1s
[22:16:39]   Epoch 30/50 | train=0.5837 | val=0.6052 | 123.8s
[22:18:43]   Epoch 31/50 | train=0.5851 | val=0.6027 | 123.8s
[22:20:46]   Epoch 32/50 | train=0.5791 | val=0.6226 | 123.3s
[22:22:49]   Epoch 33/50 | train=0.5732 | val=0.6205 | 123.3s
[22:22:49]   Early stopping at epoch 33
[22:23:06]   Optimal threshold: 0.75 (val F1=0.869)
[22:23:09]   RESULTS: acc=0.935 | f1=0.000 | auc=nan | thresh=0.75
[22:23:09]            Sensitivity(MDD)=0.000 | Specificity(H)=0.935
[22:23:09]   Fold time: 69.4 min
[22:23:10] ======================================================================
[22:23:10] FOLD 4/40 — Test Subject: H_22
[22:23:10] ======================================================================
[22:24:17]   Sequences — Train: 4945, Val: 872, Test: 153
[22:24:17]   Class balance (train): H=1708, MDD=3237 | pos_weight=1.895
[22:24:17]   Data prep: 67.2s
[22:24:18]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[22:24:18]   Starting training...
[22:26:23]   Epoch  1/50 | train=0.8277 | val=0.8065 | 125.6s
[22:28:27]   Epoch  2/50 | train=0.7510 | val=0.6373 | 123.2s
[22:30:34]   Epoch  3/50 | train=0.7014 | val=0.6346 | 127.6s
[22:32:38]   Epoch  4/50 | train=0.6836 | val=0.7184 | 123.4s
[22:34:41]   Epoch  5/50 | train=0.6656 | val=0.5999 | 123.6s
[22:36:45]   Epoch  6/50 | train=0.6590 | val=0.6156 | 123.2s
[22:38:48]   Epoch  7/50 | train=0.6507 | val=0.5989 | 122.8s
[22:40:50]   Epoch  8/50 | train=0.6450 | val=0.6007 | 122.6s
[22:42:53]   Epoch  9/50 | train=0.6522 | val=0.6511 | 122.4s
[22:44:56]   Epoch 10/50 | train=0.6362 | val=0.5896 | 122.8s
[22:46:58]   Epoch 11/50 | train=0.6385 | val=0.5892 | 122.4s
[22:49:01]   Epoch 12/50 | train=0.6438 | val=0.6593 | 122.8s
[22:51:03]   Epoch 13/50 | train=0.6295 | val=0.6002 | 122.3s
[22:53:06]   Epoch 14/50 | train=0.6196 | val=0.6515 | 123.2s
[22:55:10]   Epoch 15/50 | train=0.6316 | val=0.6013 | 123.3s
[22:57:13]   Epoch 16/50 | train=0.6265 | val=0.5893 | 122.8s
[22:59:15]   Epoch 17/50 | train=0.6187 | val=0.6087 | 122.2s
[23:01:17]   Epoch 18/50 | train=0.6238 | val=0.6226 | 122.4s
[23:03:20]   Epoch 19/50 | train=0.6086 | val=0.5887 | 122.5s
[23:05:22]   Epoch 20/50 | train=0.6120 | val=0.5828 | 122.4s
[23:07:25]   Epoch 21/50 | train=0.6181 | val=0.5874 | 123.1s
[23:09:28]   Epoch 22/50 | train=0.5960 | val=0.6123 | 122.3s
[23:11:31]   Epoch 23/50 | train=0.5952 | val=0.5828 | 123.4s
[23:13:36]   Epoch 24/50 | train=0.5950 | val=0.5791 | 125.1s
[23:15:40]   Epoch 25/50 | train=0.5930 | val=0.5857 | 123.8s
[23:17:44]   Epoch 26/50 | train=0.5917 | val=0.6543 | 123.5s
[23:19:47]   Epoch 27/50 | train=0.5987 | val=0.5927 | 123.5s
[23:21:51]   Epoch 28/50 | train=0.5775 | val=0.6379 | 123.7s
[23:23:55]   Epoch 29/50 | train=0.5849 | val=0.5926 | 123.8s
[23:25:59]   Epoch 30/50 | train=0.5823 | val=0.5776 | 123.9s
[23:28:02]   Epoch 31/50 | train=0.5821 | val=0.5814 | 123.6s
[23:30:06]   Epoch 32/50 | train=0.5739 | val=0.6039 | 123.3s
[23:32:09]   Epoch 33/50 | train=0.5778 | val=0.5749 | 123.7s
[23:34:13]   Epoch 34/50 | train=0.5748 | val=0.5658 | 123.3s
[23:36:16]   Epoch 35/50 | train=0.5702 | val=0.5913 | 123.4s
[23:38:20]   Epoch 36/50 | train=0.5638 | val=0.5803 | 124.1s
[23:40:24]   Epoch 37/50 | train=0.5584 | val=0.5738 | 123.9s
[23:42:28]   Epoch 38/50 | train=0.5509 | val=0.6170 | 123.6s
[23:44:32]   Epoch 39/50 | train=0.5481 | val=0.6027 | 123.7s
[23:46:35]   Epoch 40/50 | train=0.5631 | val=0.5852 | 123.6s
[23:48:39]   Epoch 41/50 | train=0.5584 | val=0.5896 | 123.5s
[23:50:43]   Epoch 42/50 | train=0.5538 | val=0.5634 | 124.1s
[23:52:46]   Epoch 43/50 | train=0.5340 | val=0.6187 | 123.4s
[23:54:51]   Epoch 44/50 | train=0.5524 | val=0.5660 | 124.6s
[23:56:55]   Epoch 45/50 | train=0.5335 | val=0.5820 | 123.9s
[23:58:59]   Epoch 46/50 | train=0.5418 | val=0.5683 | 123.9s
[00:01:03]   Epoch 47/50 | train=0.5272 | val=0.5786 | 124.1s
[00:03:07]   Epoch 48/50 | train=0.5277 | val=0.5744 | 124.0s
[00:05:11]   Epoch 49/50 | train=0.5256 | val=0.6211 | 123.8s
[00:07:15]   Epoch 50/50 | train=0.5316 | val=0.5779 | 124.3s
[00:07:31]   Optimal threshold: 0.75 (val F1=0.880)
[00:07:37]   RESULTS: acc=0.837 | f1=0.000 | auc=nan | thresh=0.75
[00:07:37]            Sensitivity(MDD)=0.000 | Specificity(H)=0.837
[00:07:37]   Fold time: 104.4 min
[00:07:38] ======================================================================
[00:07:38] FOLD 5/40 — Test Subject: H_23
[00:07:38] ======================================================================
[00:08:46]   Sequences — Train: 4948, Val: 872, Test: 150
[00:08:46]   Class balance (train): H=1711, MDD=3237 | pos_weight=1.892
[00:08:46]   Data prep: 67.3s
[00:08:46]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[00:08:46]   Starting training...
[00:10:55]   Epoch  1/50 | train=0.8150 | val=0.7213 | 129.0s
[00:13:01]   Epoch  2/50 | train=0.7359 | val=0.7019 | 126.4s
[00:15:10]   Epoch  3/50 | train=0.6937 | val=0.6345 | 128.7s
[00:17:15]   Epoch  4/50 | train=0.6753 | val=0.6110 | 124.9s
[00:19:21]   Epoch  5/50 | train=0.6712 | val=0.5985 | 125.1s
[00:21:25]   Epoch  6/50 | train=0.6526 | val=0.6212 | 124.6s
[00:23:30]   Epoch  7/50 | train=0.6539 | val=0.6747 | 124.3s
[00:25:34]   Epoch  8/50 | train=0.6494 | val=0.7414 | 124.6s
[00:27:39]   Epoch  9/50 | train=0.6524 | val=0.6254 | 124.8s
[00:29:44]   Epoch 10/50 | train=0.6380 | val=0.6003 | 124.6s
[00:31:48]   Epoch 11/50 | train=0.6364 | val=0.6049 | 124.1s
[00:33:52]   Epoch 12/50 | train=0.6298 | val=0.5965 | 124.2s
[00:35:56]   Epoch 13/50 | train=0.6333 | val=0.5807 | 124.1s
[00:38:00]   Epoch 14/50 | train=0.6355 | val=0.6039 | 123.8s
[00:40:04]   Epoch 15/50 | train=0.6192 | val=0.6286 | 124.5s
[00:42:08]   Epoch 16/50 | train=0.6198 | val=0.5845 | 124.0s
[00:44:13]   Epoch 17/50 | train=0.6276 | val=0.5965 | 124.4s
[00:46:17]   Epoch 18/50 | train=0.6111 | val=0.6334 | 124.3s
[00:48:21]   Epoch 19/50 | train=0.6085 | val=0.6158 | 124.0s
[00:50:25]   Epoch 20/50 | train=0.6091 | val=0.5822 | 124.0s
[00:52:29]   Epoch 21/50 | train=0.6035 | val=0.5957 | 124.2s
[00:54:34]   Epoch 22/50 | train=0.6045 | val=0.5832 | 125.1s
[00:56:39]   Epoch 23/50 | train=0.6067 | val=0.5903 | 124.3s
[00:56:39]   Early stopping at epoch 23
[00:56:55]   Optimal threshold: 0.55 (val F1=0.872)
[00:57:02]   RESULTS: acc=0.793 | f1=0.000 | auc=nan | thresh=0.55
[00:57:02]            Sensitivity(MDD)=0.000 | Specificity(H)=0.793
[00:57:02]   Fold time: 49.4 min
[00:57:04] ======================================================================
[00:57:04] FOLD 6/40 — Test Subject: H_24
[00:57:04] ======================================================================
[00:58:08]   Sequences — Train: 4944, Val: 872, Test: 154
[00:58:08]   Class balance (train): H=1707, MDD=3237 | pos_weight=1.896
[00:58:08]   Data prep: 63.7s
[00:58:08]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[00:58:08]   Starting training...
[01:00:13]   Epoch  1/50 | train=0.8085 | val=0.7049 | 124.6s
[01:02:17]   Epoch  2/50 | train=0.6919 | val=0.6517 | 124.1s
[01:04:26]   Epoch  3/50 | train=0.6350 | val=0.6603 | 129.2s
[01:06:32]   Epoch  4/50 | train=0.6310 | val=0.6676 | 125.5s
[01:08:38]   Epoch  5/50 | train=0.6204 | val=0.6044 | 126.1s
[01:10:45]   Epoch  6/50 | train=0.6140 | val=0.6152 | 127.4s
[01:12:50]   Epoch  7/50 | train=0.6013 | val=0.6051 | 124.6s
[01:14:57]   Epoch  8/50 | train=0.5983 | val=0.6277 | 126.6s
[01:17:06]   Epoch  9/50 | train=0.5914 | val=0.6172 | 129.6s
[01:19:19]   Epoch 10/50 | train=0.5885 | val=0.6233 | 132.4s
[01:21:26]   Epoch 11/50 | train=0.5854 | val=0.7119 | 127.1s
[01:23:30]   Epoch 12/50 | train=0.5813 | val=0.6123 | 124.4s
[01:25:35]   Epoch 13/50 | train=0.5796 | val=0.5986 | 124.4s
[01:27:39]   Epoch 14/50 | train=0.5689 | val=0.7042 | 124.6s
[01:29:44]   Epoch 15/50 | train=0.5724 | val=0.6274 | 124.5s
[01:31:48]   Epoch 16/50 | train=0.5755 | val=0.5930 | 124.2s
[01:33:52]   Epoch 17/50 | train=0.5650 | val=0.5948 | 124.2s
[01:35:56]   Epoch 18/50 | train=0.5594 | val=0.6476 | 124.0s
[01:38:00]   Epoch 19/50 | train=0.5588 | val=0.5969 | 124.1s
[01:40:04]   Epoch 20/50 | train=0.5487 | val=0.6427 | 124.0s
[01:42:09]   Epoch 21/50 | train=0.5621 | val=0.6685 | 124.1s
[01:44:13]   Epoch 22/50 | train=0.5551 | val=0.6110 | 124.2s
[01:46:17]   Epoch 23/50 | train=0.5553 | val=0.6169 | 124.4s
[01:48:21]   Epoch 24/50 | train=0.5461 | val=0.6250 | 124.2s
[01:50:26]   Epoch 25/50 | train=0.5419 | val=0.5834 | 124.2s
[01:52:31]   Epoch 26/50 | train=0.5408 | val=0.5963 | 125.0s
[01:54:35]   Epoch 27/50 | train=0.5411 | val=0.6053 | 124.5s
[01:56:43]   Epoch 28/50 | train=0.5222 | val=0.6294 | 128.0s
[01:58:59]   Epoch 29/50 | train=0.5309 | val=0.6635 | 136.1s
[02:01:09]   Epoch 30/50 | train=0.5381 | val=0.6378 | 130.1s
[02:03:15]   Epoch 31/50 | train=0.5228 | val=0.6029 | 125.9s
[02:05:21]   Epoch 32/50 | train=0.5227 | val=0.6146 | 125.3s
[02:07:27]   Epoch 33/50 | train=0.5176 | val=0.6154 | 125.8s
[02:09:32]   Epoch 34/50 | train=0.5275 | val=0.5881 | 125.4s
[02:11:37]   Epoch 35/50 | train=0.5175 | val=0.6293 | 125.2s
[02:11:37]   Early stopping at epoch 35
[02:11:54]   Optimal threshold: 0.70 (val F1=0.875)
[02:11:57]   RESULTS: acc=0.000 | f1=0.000 | auc=nan | thresh=0.70
[02:11:57]            Sensitivity(MDD)=0.000 | Specificity(H)=0.000
[02:11:57]   Fold time: 74.9 min
[02:11:58] ======================================================================
[02:11:58] FOLD 7/40 — Test Subject: H_26
[02:11:58] ======================================================================
[02:13:05]   Sequences — Train: 4936, Val: 870, Test: 164
[02:13:05]   Class balance (train): H=1699, MDD=3237 | pos_weight=1.905
[02:13:05]   Data prep: 66.7s
[02:13:05]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[02:13:05]   Starting training...
[02:15:14]   Epoch  1/50 | train=0.8231 | val=0.7454 | 128.9s
[02:17:21]   Epoch  2/50 | train=0.7390 | val=0.6294 | 127.0s
[02:19:29]   Epoch  3/50 | train=0.6912 | val=0.6244 | 127.7s
[02:21:34]   Epoch  4/50 | train=0.6800 | val=0.6173 | 125.2s
[02:23:40]   Epoch  5/50 | train=0.6611 | val=0.6595 | 125.3s
[02:25:45]   Epoch  6/50 | train=0.6532 | val=0.6065 | 125.3s
[02:27:50]   Epoch  7/50 | train=0.6530 | val=0.6154 | 124.5s
[02:29:54]   Epoch  8/50 | train=0.6461 | val=0.6002 | 124.7s
[02:32:00]   Epoch  9/50 | train=0.6481 | val=0.6114 | 125.1s
[02:34:05]   Epoch 10/50 | train=0.6395 | val=0.6117 | 125.0s
[02:36:09]   Epoch 11/50 | train=0.6309 | val=0.5868 | 124.9s
[02:38:15]   Epoch 12/50 | train=0.6264 | val=0.6437 | 125.1s
[02:40:20]   Epoch 13/50 | train=0.6272 | val=0.6232 | 125.2s
[02:42:24]   Epoch 14/50 | train=0.6238 | val=0.5733 | 124.5s
[02:44:29]   Epoch 15/50 | train=0.6172 | val=0.6128 | 124.8s
[02:46:34]   Epoch 16/50 | train=0.6157 | val=0.5941 | 124.7s
[02:48:38]   Epoch 17/50 | train=0.6143 | val=0.5962 | 124.5s
[02:50:43]   Epoch 18/50 | train=0.6131 | val=0.6049 | 124.9s
[02:52:48]   Epoch 19/50 | train=0.6207 | val=0.5965 | 124.5s
[02:54:53]   Epoch 20/50 | train=0.6032 | val=0.6242 | 124.7s
[02:56:57]   Epoch 21/50 | train=0.5995 | val=0.6043 | 124.5s
[02:59:03]   Epoch 22/50 | train=0.6097 | val=0.5814 | 125.6s
[03:01:08]   Epoch 23/50 | train=0.6047 | val=0.5825 | 124.9s
[03:03:12]   Epoch 24/50 | train=0.5979 | val=0.5880 | 124.4s
[03:03:12]   Early stopping at epoch 24
[03:03:28]   Optimal threshold: 0.65 (val F1=0.871)
[03:03:32]   RESULTS: acc=0.689 | f1=0.000 | auc=nan | thresh=0.65
[03:03:32]            Sensitivity(MDD)=0.000 | Specificity(H)=0.689
[03:03:32]   Fold time: 51.6 min
[03:03:33] ======================================================================
[03:03:33] FOLD 8/40 — Test Subject: H_27
[03:03:33] ======================================================================
[03:04:37]   Sequences — Train: 4928, Val: 869, Test: 173
[03:04:37]   Class balance (train): H=1691, MDD=3237 | pos_weight=1.914
[03:04:37]   Data prep: 64.1s
[03:04:37]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[03:04:37]   Starting training...
[03:06:39]   Epoch  1/50 | train=0.8103 | val=0.7042 | 121.6s
[03:08:41]   Epoch  2/50 | train=0.6985 | val=0.5942 | 121.4s
[03:10:50]   Epoch  3/50 | train=0.6554 | val=0.5805 | 129.0s
[03:12:55]   Epoch  4/50 | train=0.6298 | val=0.5761 | 125.7s
[03:15:01]   Epoch  5/50 | train=0.6254 | val=0.5361 | 125.5s
[03:17:06]   Epoch  6/50 | train=0.6128 | val=0.5735 | 125.0s
[03:19:11]   Epoch  7/50 | train=0.6077 | val=0.5875 | 124.8s
[03:21:15]   Epoch  8/50 | train=0.5917 | val=0.5952 | 124.4s
[03:23:20]   Epoch  9/50 | train=0.5940 | val=0.6022 | 124.6s
[03:25:24]   Epoch 10/50 | train=0.5859 | val=0.5575 | 124.3s
[03:27:28]   Epoch 11/50 | train=0.5865 | val=0.5476 | 124.2s
[03:29:33]   Epoch 12/50 | train=0.5779 | val=0.5381 | 124.3s
[03:31:37]   Epoch 13/50 | train=0.5793 | val=0.5497 | 124.4s
[03:33:42]   Epoch 14/50 | train=0.5678 | val=0.5522 | 124.5s
[03:35:46]   Epoch 15/50 | train=0.5723 | val=0.5253 | 124.5s
[03:37:51]   Epoch 16/50 | train=0.5713 | val=0.5318 | 125.0s
[03:39:56]   Epoch 17/50 | train=0.5585 | val=0.5317 | 125.0s
[03:42:01]   Epoch 18/50 | train=0.5535 | val=0.5429 | 124.9s
[03:44:05]   Epoch 19/50 | train=0.5678 | val=0.5340 | 124.2s
[03:46:10]   Epoch 20/50 | train=0.5535 | val=0.5852 | 124.2s
[03:48:14]   Epoch 21/50 | train=0.5412 | val=0.5432 | 124.2s
[03:50:18]   Epoch 22/50 | train=0.5451 | val=0.5194 | 124.1s
[03:52:22]   Epoch 23/50 | train=0.5342 | val=0.5360 | 124.3s
[03:54:27]   Epoch 24/50 | train=0.5507 | val=0.5442 | 124.6s
[03:56:31]   Epoch 25/50 | train=0.5372 | val=0.5761 | 124.2s
[03:58:36]   Epoch 26/50 | train=0.5403 | val=0.5217 | 124.9s
[04:00:40]   Epoch 27/50 | train=0.5403 | val=0.5742 | 124.4s
[04:02:45]   Epoch 28/50 | train=0.5346 | val=0.5710 | 124.7s
[04:04:49]   Epoch 29/50 | train=0.5214 | val=0.5208 | 124.1s
[04:06:54]   Epoch 30/50 | train=0.5180 | val=0.5162 | 124.8s
[04:08:58]   Epoch 31/50 | train=0.5125 | val=0.5561 | 124.2s
[04:11:02]   Epoch 32/50 | train=0.5030 | val=0.5173 | 124.3s
[04:13:07]   Epoch 33/50 | train=0.5155 | val=0.5190 | 124.5s
[04:15:11]   Epoch 34/50 | train=0.5135 | val=0.5096 | 124.4s
[04:17:16]   Epoch 35/50 | train=0.5208 | val=0.5217 | 124.0s
[04:19:20]   Epoch 36/50 | train=0.5015 | val=0.5236 | 124.4s
[04:21:24]   Epoch 37/50 | train=0.4980 | val=0.5326 | 124.2s
[04:23:28]   Epoch 38/50 | train=0.5025 | val=0.5002 | 123.9s
[04:25:32]   Epoch 39/50 | train=0.4825 | val=0.5081 | 123.9s
[04:27:36]   Epoch 40/50 | train=0.4849 | val=0.5048 | 124.0s
[04:29:40]   Epoch 41/50 | train=0.4842 | val=0.5041 | 124.2s
[04:31:45]   Epoch 42/50 | train=0.4809 | val=0.5190 | 124.3s
[04:33:49]   Epoch 43/50 | train=0.4880 | val=0.5095 | 124.3s
[04:35:53]   Epoch 44/50 | train=0.4932 | val=0.5166 | 124.3s
[04:37:57]   Epoch 45/50 | train=0.4717 | val=0.5290 | 123.9s
[04:40:01]   Epoch 46/50 | train=0.4760 | val=0.5352 | 124.1s
[04:42:06]   Epoch 47/50 | train=0.4720 | val=0.5233 | 124.3s
[04:44:10]   Epoch 48/50 | train=0.4620 | val=0.5754 | 124.2s
[04:44:10]   Early stopping at epoch 48
[04:44:26]   Optimal threshold: 0.70 (val F1=0.900)
[04:44:31]   RESULTS: acc=0.000 | f1=0.000 | auc=nan | thresh=0.70
[04:44:31]            Sensitivity(MDD)=0.000 | Specificity(H)=0.000
[04:44:31]   Fold time: 101.0 min
[04:44:33] ======================================================================
[04:44:33] FOLD 9/40 — Test Subject: H_28
[04:44:33] ======================================================================
[04:45:39]   Sequences — Train: 4935, Val: 870, Test: 165
[04:45:39]   Class balance (train): H=1698, MDD=3237 | pos_weight=1.906
[04:45:39]   Data prep: 66.4s
[04:45:39]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[04:45:39]   Starting training...
[04:47:52]   Epoch  1/50 | train=0.8208 | val=0.8031 | 132.7s
[04:50:01]   Epoch  2/50 | train=0.7474 | val=0.7199 | 129.0s
[04:52:09]   Epoch  3/50 | train=0.7046 | val=0.6566 | 127.2s
[04:54:13]   Epoch  4/50 | train=0.6732 | val=0.6646 | 124.5s
[04:56:18]   Epoch  5/50 | train=0.6778 | val=0.6433 | 125.0s
[04:58:24]   Epoch  6/50 | train=0.6558 | val=0.6436 | 125.4s
[05:00:29]   Epoch  7/50 | train=0.6542 | val=0.6636 | 125.0s
[05:02:33]   Epoch  8/50 | train=0.6539 | val=0.6379 | 124.6s
[05:04:38]   Epoch  9/50 | train=0.6462 | val=0.6511 | 124.4s
[05:06:43]   Epoch 10/50 | train=0.6370 | val=0.6512 | 125.0s
[05:08:47]   Epoch 11/50 | train=0.6416 | val=0.6427 | 124.7s
[05:10:52]   Epoch 12/50 | train=0.6297 | val=0.6422 | 124.3s
[05:12:56]   Epoch 13/50 | train=0.6265 | val=0.6399 | 124.6s
[05:15:01]   Epoch 14/50 | train=0.6240 | val=0.6471 | 124.6s
[05:17:06]   Epoch 15/50 | train=0.6202 | val=0.6562 | 125.0s
[05:19:10]   Epoch 16/50 | train=0.6192 | val=0.6612 | 124.4s
[05:21:16]   Epoch 17/50 | train=0.6189 | val=0.6383 | 125.4s
[05:23:20]   Epoch 18/50 | train=0.6147 | val=0.7276 | 124.5s
[05:23:20]   Early stopping at epoch 18
[05:23:37]   Optimal threshold: 0.55 (val F1=0.859)
[05:23:42]   RESULTS: acc=0.915 | f1=0.000 | auc=nan | thresh=0.55
[05:23:42]            Sensitivity(MDD)=0.000 | Specificity(H)=0.915
[05:23:42]   Fold time: 39.2 min
[05:23:43] ======================================================================
[05:23:43] FOLD 10/40 — Test Subject: H_4
[05:23:43] ======================================================================
[05:24:49]   Sequences — Train: 4933, Val: 870, Test: 167
[05:24:49]   Class balance (train): H=1696, MDD=3237 | pos_weight=1.909
[05:24:49]   Data prep: 66.1s
[05:24:50]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[05:24:50]   Starting training...
[05:27:05]   Epoch  1/50 | train=0.8126 | val=0.7890 | 134.8s
[05:29:13]   Epoch  2/50 | train=0.7272 | val=0.6165 | 128.7s
[05:31:20]   Epoch  3/50 | train=0.6928 | val=0.7428 | 126.6s
[05:33:25]   Epoch  4/50 | train=0.6766 | val=0.7202 | 124.7s
[05:35:30]   Epoch  5/50 | train=0.6544 | val=0.6363 | 124.8s
[05:37:34]   Epoch  6/50 | train=0.6645 | val=0.6418 | 124.6s
[05:39:39]   Epoch  7/50 | train=0.6517 | val=0.6382 | 124.6s
[05:41:44]   Epoch  8/50 | train=0.6473 | val=0.6266 | 124.7s
[05:43:48]   Epoch  9/50 | train=0.6386 | val=0.5800 | 124.6s
[05:45:53]   Epoch 10/50 | train=0.6350 | val=0.5952 | 124.7s
[05:47:58]   Epoch 11/50 | train=0.6327 | val=0.5838 | 124.6s
[05:50:02]   Epoch 12/50 | train=0.6202 | val=0.5873 | 124.6s
[05:52:07]   Epoch 13/50 | train=0.6278 | val=0.6598 | 124.7s
[05:54:11]   Epoch 14/50 | train=0.6311 | val=0.6028 | 124.4s
[05:56:16]   Epoch 15/50 | train=0.6222 | val=0.5764 | 124.9s
[05:58:22]   Epoch 16/50 | train=0.6201 | val=0.5797 | 125.5s
[06:00:28]   Epoch 17/50 | train=0.6213 | val=0.5907 | 125.7s
[06:02:32]   Epoch 18/50 | train=0.6219 | val=0.6105 | 124.3s
[06:04:36]   Epoch 19/50 | train=0.6131 | val=0.5975 | 124.3s
[06:06:41]   Epoch 20/50 | train=0.6054 | val=0.5777 | 125.2s
[06:08:46]   Epoch 21/50 | train=0.6077 | val=0.5777 | 124.2s
[06:10:50]   Epoch 22/50 | train=0.5958 | val=0.5978 | 124.4s
[06:12:54]   Epoch 23/50 | train=0.6086 | val=0.6352 | 124.2s
[06:14:59]   Epoch 24/50 | train=0.5962 | val=0.6280 | 124.5s
[06:17:03]   Epoch 25/50 | train=0.5931 | val=0.5965 | 124.4s
[06:17:03]   Early stopping at epoch 25
[06:17:19]   Optimal threshold: 0.55 (val F1=0.881)
[06:17:25]   RESULTS: acc=0.719 | f1=0.000 | auc=nan | thresh=0.55
[06:17:25]            Sensitivity(MDD)=0.000 | Specificity(H)=0.719
[06:17:25]   Fold time: 53.7 min
[06:17:26] ======================================================================
[06:17:26] FOLD 11/40 — Test Subject: H_5
[06:17:26] ======================================================================
[06:18:31]   Sequences — Train: 4940, Val: 871, Test: 159
[06:18:31]   Class balance (train): H=1703, MDD=3237 | pos_weight=1.901
[06:18:31]   Data prep: 65.0s
[06:18:32]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[06:18:32]   Starting training...
[06:20:58]   Epoch  1/50 | train=0.8239 | val=0.7508 | 146.1s
[06:23:08]   Epoch  2/50 | train=0.7470 | val=0.8043 | 129.3s
[06:25:14]   Epoch  3/50 | train=0.6943 | val=0.6308 | 126.6s
[06:27:20]   Epoch  4/50 | train=0.6764 | val=0.6244 | 125.0s
[06:29:25]   Epoch  5/50 | train=0.6657 | val=0.6659 | 125.3s
[06:31:30]   Epoch  6/50 | train=0.6613 | val=0.7039 | 124.9s
[06:33:35]   Epoch  7/50 | train=0.6470 | val=0.6229 | 124.8s
[06:35:39]   Epoch  8/50 | train=0.6417 | val=0.6122 | 124.5s
[06:37:44]   Epoch  9/50 | train=0.6441 | val=0.6162 | 124.8s
[06:39:49]   Epoch 10/50 | train=0.6317 | val=0.6275 | 124.8s
[06:41:54]   Epoch 11/50 | train=0.6334 | val=0.6687 | 125.1s
[06:43:59]   Epoch 12/50 | train=0.6368 | val=0.6416 | 124.9s
[06:46:04]   Epoch 13/50 | train=0.6280 | val=0.6111 | 125.0s
[06:48:09]   Epoch 14/50 | train=0.6275 | val=0.6020 | 125.1s
[06:50:14]   Epoch 15/50 | train=0.6176 | val=0.6547 | 125.1s
[06:52:19]   Epoch 16/50 | train=0.6178 | val=0.6158 | 124.9s
[06:54:24]   Epoch 17/50 | train=0.6142 | val=0.5981 | 124.8s
[06:56:29]   Epoch 18/50 | train=0.6169 | val=0.6207 | 124.5s
[06:58:35]   Epoch 19/50 | train=0.6013 | val=0.6033 | 126.0s
[07:00:40]   Epoch 20/50 | train=0.6052 | val=0.6422 | 125.0s
[07:02:45]   Epoch 21/50 | train=0.6073 | val=0.6022 | 125.4s
[07:04:50]   Epoch 22/50 | train=0.5971 | val=0.6482 | 124.7s
[07:06:55]   Epoch 23/50 | train=0.5975 | val=0.6270 | 125.5s
[07:09:00]   Epoch 24/50 | train=0.6020 | val=0.5962 | 125.0s
[07:11:05]   Epoch 25/50 | train=0.5973 | val=0.5996 | 124.9s
[07:13:11]   Epoch 26/50 | train=0.5888 | val=0.5909 | 125.3s
[07:15:17]   Epoch 27/50 | train=0.5782 | val=0.6314 | 125.8s
[07:17:21]   Epoch 28/50 | train=0.5777 | val=0.6252 | 124.9s
[07:19:26]   Epoch 29/50 | train=0.5783 | val=0.6016 | 124.8s
[07:21:31]   Epoch 30/50 | train=0.5803 | val=0.6155 | 125.0s
[07:23:36]   Epoch 31/50 | train=0.5716 | val=0.6063 | 125.0s
[07:25:42]   Epoch 32/50 | train=0.5778 | val=0.6047 | 125.2s
[07:27:46]   Epoch 33/50 | train=0.5623 | val=0.6156 | 124.8s
[07:29:52]   Epoch 34/50 | train=0.5693 | val=0.5890 | 125.3s
[07:31:57]   Epoch 35/50 | train=0.5706 | val=0.6026 | 124.8s
[07:34:02]   Epoch 36/50 | train=0.5689 | val=0.5943 | 125.2s
[07:36:06]   Epoch 37/50 | train=0.5585 | val=0.6452 | 124.4s
[07:38:11]   Epoch 38/50 | train=0.5563 | val=0.6196 | 124.7s
[07:40:15]   Epoch 39/50 | train=0.5663 | val=0.5859 | 124.3s
[07:42:20]   Epoch 40/50 | train=0.5440 | val=0.6181 | 124.7s
[07:44:25]   Epoch 41/50 | train=0.5479 | val=0.6035 | 124.6s
[07:46:29]   Epoch 42/50 | train=0.5543 | val=0.5899 | 124.5s
[07:48:34]   Epoch 43/50 | train=0.5304 | val=0.6317 | 124.6s
[07:50:39]   Epoch 44/50 | train=0.5363 | val=0.6051 | 125.1s
[07:52:44]   Epoch 45/50 | train=0.5408 | val=0.6282 | 125.0s
[07:54:49]   Epoch 46/50 | train=0.5411 | val=0.6336 | 124.9s
[07:56:53]   Epoch 47/50 | train=0.5356 | val=0.5911 | 124.6s
[07:58:59]   Epoch 48/50 | train=0.5209 | val=0.5970 | 125.9s
[08:01:04]   Epoch 49/50 | train=0.5192 | val=0.5933 | 125.0s
[08:01:04]   Early stopping at epoch 49
[08:01:20]   Optimal threshold: 0.80 (val F1=0.882)
[08:01:23]   RESULTS: acc=0.906 | f1=0.000 | auc=nan | thresh=0.80
[08:01:23]            Sensitivity(MDD)=0.000 | Specificity(H)=0.906
[08:01:23]   Fold time: 104.0 min
[08:01:25] ======================================================================
[08:01:25] FOLD 12/40 — Test Subject: H_6
[08:01:25] ======================================================================
[08:02:37]   Sequences — Train: 4967, Val: 876, Test: 127
[08:02:37]   Class balance (train): H=1730, MDD=3237 | pos_weight=1.871
[08:02:37]   Data prep: 72.3s
[08:02:37]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[08:02:37]   Starting training...
[08:05:09]   Epoch  1/50 | train=0.8197 | val=0.7687 | 151.8s
[08:07:16]   Epoch  2/50 | train=0.7373 | val=0.7165 | 127.0s
[08:09:22]   Epoch  3/50 | train=0.7109 | val=0.6054 | 125.3s
[08:11:27]   Epoch  4/50 | train=0.6844 | val=0.6048 | 125.1s
[08:13:32]   Epoch  5/50 | train=0.6781 | val=0.5889 | 125.3s
[08:15:38]   Epoch  6/50 | train=0.6661 | val=0.5961 | 125.4s
[08:17:43]   Epoch  7/50 | train=0.6559 | val=0.6344 | 125.5s
[08:19:49]   Epoch  8/50 | train=0.6600 | val=0.7240 | 125.3s
[08:21:54]   Epoch  9/50 | train=0.6542 | val=0.5825 | 125.6s
[08:24:00]   Epoch 10/50 | train=0.6469 | val=0.6353 | 125.2s
[08:26:05]   Epoch 11/50 | train=0.6415 | val=0.6452 | 125.7s
[08:28:11]   Epoch 12/50 | train=0.6355 | val=0.6232 | 125.1s
[08:30:16]   Epoch 13/50 | train=0.6269 | val=0.6059 | 125.3s
[08:32:21]   Epoch 14/50 | train=0.6255 | val=0.5747 | 125.0s
[08:34:26]   Epoch 15/50 | train=0.6288 | val=0.5948 | 125.4s
[08:36:32]   Epoch 16/50 | train=0.6288 | val=0.5873 | 125.2s
[08:38:37]   Epoch 17/50 | train=0.6187 | val=0.5925 | 124.9s
[08:40:42]   Epoch 18/50 | train=0.6166 | val=0.5998 | 125.8s
[08:42:48]   Epoch 19/50 | train=0.6160 | val=0.5788 | 125.2s
[08:44:53]   Epoch 20/50 | train=0.6148 | val=0.5674 | 125.5s
[08:46:59]   Epoch 21/50 | train=0.6170 | val=0.5864 | 125.3s
[08:49:04]   Epoch 22/50 | train=0.6057 | val=0.5841 | 125.0s
[08:51:09]   Epoch 23/50 | train=0.5990 | val=0.5905 | 125.3s
[08:53:14]   Epoch 24/50 | train=0.5974 | val=0.6166 | 125.1s
[08:55:19]   Epoch 25/50 | train=0.5984 | val=0.6235 | 125.1s
[08:57:24]   Epoch 26/50 | train=0.6023 | val=0.5736 | 125.4s
[08:59:30]   Epoch 27/50 | train=0.5936 | val=0.5805 | 126.0s
[09:01:36]   Epoch 28/50 | train=0.5830 | val=0.6086 | 125.2s
[09:03:41]   Epoch 29/50 | train=0.5970 | val=0.5527 | 125.7s
[09:05:47]   Epoch 30/50 | train=0.5897 | val=0.5732 | 125.2s
[09:07:52]   Epoch 31/50 | train=0.5821 | val=0.5713 | 125.6s
[09:09:58]   Epoch 32/50 | train=0.5776 | val=0.5806 | 125.3s
[09:12:03]   Epoch 33/50 | train=0.5807 | val=0.5592 | 125.0s
[09:14:08]   Epoch 34/50 | train=0.5599 | val=0.5841 | 125.3s
[09:16:13]   Epoch 35/50 | train=0.5714 | val=0.5605 | 125.3s
[09:18:18]   Epoch 36/50 | train=0.5753 | val=0.6051 | 125.0s
[09:20:23]   Epoch 37/50 | train=0.5693 | val=0.5865 | 125.1s
[09:22:29]   Epoch 38/50 | train=0.5569 | val=0.5936 | 125.1s
[09:24:34]   Epoch 39/50 | train=0.5653 | val=0.5697 | 125.5s
[09:24:34]   Early stopping at epoch 39
[09:24:51]   Optimal threshold: 0.75 (val F1=0.880)
[09:24:55]   RESULTS: acc=0.890 | f1=0.000 | auc=nan | thresh=0.75
[09:24:55]            Sensitivity(MDD)=0.000 | Specificity(H)=0.890
[09:24:55]   Fold time: 83.5 min
[09:24:56] ======================================================================
[09:24:56] FOLD 13/40 — Test Subject: H_8
[09:24:56] ======================================================================
[09:26:06]   Sequences — Train: 4932, Val: 870, Test: 168
[09:26:06]   Class balance (train): H=1695, MDD=3237 | pos_weight=1.910
[09:26:06]   Data prep: 69.6s
[09:26:06]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[09:26:06]   Starting training...
[09:28:20]   Epoch  1/50 | train=0.8222 | val=0.7591 | 133.4s
[09:30:25]   Epoch  2/50 | train=0.7346 | val=0.6583 | 125.2s
[09:32:33]   Epoch  3/50 | train=0.6974 | val=0.6254 | 127.9s
[09:34:37]   Epoch  4/50 | train=0.6748 | val=0.6200 | 123.7s
[09:36:41]   Epoch  5/50 | train=0.6654 | val=0.6330 | 124.3s
[09:38:45]   Epoch  6/50 | train=0.6556 | val=0.6084 | 123.7s
[09:40:48]   Epoch  7/50 | train=0.6584 | val=0.6100 | 123.1s
[09:42:53]   Epoch  8/50 | train=0.6409 | val=0.6235 | 124.3s
[09:45:01]   Epoch  9/50 | train=0.6401 | val=0.6312 | 128.4s
[09:47:12]   Epoch 10/50 | train=0.6409 | val=0.6192 | 130.6s
[09:49:24]   Epoch 11/50 | train=0.6294 | val=0.6295 | 132.8s
[09:51:34]   Epoch 12/50 | train=0.6340 | val=0.6047 | 129.7s
[09:53:39]   Epoch 13/50 | train=0.6256 | val=0.6020 | 124.9s
[09:55:41]   Epoch 14/50 | train=0.6281 | val=0.5948 | 122.1s
[09:57:43]   Epoch 15/50 | train=0.6253 | val=0.6269 | 121.4s
[09:59:46]   Epoch 16/50 | train=0.6154 | val=0.6556 | 122.6s
[10:01:49]   Epoch 17/50 | train=0.6104 | val=0.6149 | 123.5s
[10:03:53]   Epoch 18/50 | train=0.6071 | val=0.5998 | 124.2s
[10:05:56]   Epoch 19/50 | train=0.6039 | val=0.6015 | 122.4s
[10:07:59]   Epoch 20/50 | train=0.6050 | val=0.5885 | 123.2s
[10:10:02]   Epoch 21/50 | train=0.6002 | val=0.6136 | 122.8s
[10:12:05]   Epoch 22/50 | train=0.6039 | val=0.5996 | 122.7s
[10:14:07]   Epoch 23/50 | train=0.6019 | val=0.6219 | 122.7s
[10:16:10]   Epoch 24/50 | train=0.5858 | val=0.6124 | 122.5s
[10:18:13]   Epoch 25/50 | train=0.6024 | val=0.6177 | 122.9s
[10:20:15]   Epoch 26/50 | train=0.5953 | val=0.6260 | 122.8s
[10:22:18]   Epoch 27/50 | train=0.5823 | val=0.6084 | 122.5s
[10:24:21]   Epoch 28/50 | train=0.5862 | val=0.6192 | 122.9s
[10:26:27]   Epoch 29/50 | train=0.5834 | val=0.5920 | 126.1s
[10:28:36]   Epoch 30/50 | train=0.5855 | val=0.5917 | 129.4s
[10:28:36]   Early stopping at epoch 30
[10:28:53]   Optimal threshold: 0.65 (val F1=0.875)
[10:29:00]   RESULTS: acc=0.774 | f1=0.000 | auc=nan | thresh=0.65
[10:29:00]            Sensitivity(MDD)=0.000 | Specificity(H)=0.774
[10:29:00]   Fold time: 64.1 min
[10:29:01] ======================================================================
[10:29:01] FOLD 14/40 — Test Subject: H_9
[10:29:01] ======================================================================
[10:30:09]   Sequences — Train: 4958, Val: 874, Test: 138
[10:30:09]   Class balance (train): H=1721, MDD=3237 | pos_weight=1.881
[10:30:09]   Data prep: 67.1s
[10:30:09]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[10:30:09]   Starting training...
[10:32:39]   Epoch  1/50 | train=0.8216 | val=0.7527 | 149.9s
[10:34:49]   Epoch  2/50 | train=0.7546 | val=0.6222 | 130.0s
[10:37:04]   Epoch  3/50 | train=0.6984 | val=0.6544 | 135.2s
[10:39:20]   Epoch  4/50 | train=0.6826 | val=0.6536 | 135.5s
[10:41:35]   Epoch  5/50 | train=0.6679 | val=0.6267 | 135.9s
[10:43:49]   Epoch  6/50 | train=0.6691 | val=0.5975 | 133.3s
[10:46:01]   Epoch  7/50 | train=0.6623 | val=0.6078 | 132.5s
[10:48:17]   Epoch  8/50 | train=0.6642 | val=0.6004 | 135.4s
[10:50:30]   Epoch  9/50 | train=0.6527 | val=0.5839 | 133.2s
[10:52:42]   Epoch 10/50 | train=0.6398 | val=0.7001 | 132.0s
[10:54:56]   Epoch 11/50 | train=0.6288 | val=0.6467 | 133.7s
[10:57:10]   Epoch 12/50 | train=0.6408 | val=0.5956 | 134.0s
[10:59:22]   Epoch 13/50 | train=0.6309 | val=0.5967 | 132.0s
[11:01:36]   Epoch 14/50 | train=0.6367 | val=0.6476 | 134.3s
[11:03:52]   Epoch 15/50 | train=0.6229 | val=0.5870 | 135.4s
[11:06:08]   Epoch 16/50 | train=0.6288 | val=0.5818 | 136.9s
[11:08:24]   Epoch 17/50 | train=0.6244 | val=0.5929 | 135.0s
[11:10:40]   Epoch 18/50 | train=0.6122 | val=0.6578 | 136.3s
[11:12:55]   Epoch 19/50 | train=0.6214 | val=0.6062 | 134.9s
[11:15:06]   Epoch 20/50 | train=0.6105 | val=0.5917 | 131.3s
[11:17:16]   Epoch 21/50 | train=0.6090 | val=0.5955 | 129.5s
[11:19:26]   Epoch 22/50 | train=0.6008 | val=0.6029 | 130.1s
[11:21:37]   Epoch 23/50 | train=0.6025 | val=0.5958 | 130.8s
[11:23:47]   Epoch 24/50 | train=0.5976 | val=0.5797 | 130.0s
[11:25:54]   Epoch 25/50 | train=0.5990 | val=0.6444 | 127.4s
[11:28:03]   Epoch 26/50 | train=0.5925 | val=0.5709 | 128.6s
[11:30:07]   Epoch 27/50 | train=0.5935 | val=0.5859 | 124.6s
[11:32:11]   Epoch 28/50 | train=0.5891 | val=0.5981 | 123.6s
[11:34:14]   Epoch 29/50 | train=0.5803 | val=0.6445 | 122.5s
[11:36:16]   Epoch 30/50 | train=0.5853 | val=0.5685 | 122.3s
[11:38:16]   Epoch 31/50 | train=0.5723 | val=0.5905 | 119.8s
[11:40:16]   Epoch 32/50 | train=0.5824 | val=0.5858 | 120.2s
[11:42:18]   Epoch 33/50 | train=0.5868 | val=0.5721 | 122.2s
[11:44:20]   Epoch 34/50 | train=0.5649 | val=0.5791 | 122.1s
[11:46:22]   Epoch 35/50 | train=0.5685 | val=0.6857 | 121.9s
[11:48:25]   Epoch 36/50 | train=0.5642 | val=0.6493 | 122.3s
[11:50:27]   Epoch 37/50 | train=0.5638 | val=0.5859 | 122.7s
[11:52:30]   Epoch 38/50 | train=0.5644 | val=0.5843 | 122.9s
[11:54:35]   Epoch 39/50 | train=0.5656 | val=0.6146 | 124.7s
[11:56:39]   Epoch 40/50 | train=0.5584 | val=0.6038 | 123.7s
[11:56:39]   Early stopping at epoch 40
[11:56:54]   Optimal threshold: 0.55 (val F1=0.874)
[11:56:57]   RESULTS: acc=0.826 | f1=0.000 | auc=nan | thresh=0.55
[11:56:57]            Sensitivity(MDD)=0.000 | Specificity(H)=0.826
[11:56:57]   Fold time: 87.9 min
[11:56:58] ======================================================================
[11:56:58] FOLD 15/40 — Test Subject: MDD_1
[11:56:58] ======================================================================
[11:58:11]   Sequences — Train: 4935, Val: 870, Test: 165
[11:58:11]   Class balance (train): H=1838, MDD=3097 | pos_weight=1.685
[11:58:11]   Data prep: 72.8s
[11:58:12]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[11:58:12]   Starting training...
[12:00:42]   Epoch  1/50 | train=0.8081 | val=0.7329 | 150.0s
[12:02:52]   Epoch  2/50 | train=0.7122 | val=0.6002 | 130.6s
[12:05:01]   Epoch  3/50 | train=0.6689 | val=0.5850 | 129.0s
[12:07:06]   Epoch  4/50 | train=0.6687 | val=0.5879 | 124.4s
[12:09:09]   Epoch  5/50 | train=0.6416 | val=0.5881 | 123.0s
[12:11:12]   Epoch  6/50 | train=0.6324 | val=0.5870 | 123.2s
[12:13:16]   Epoch  7/50 | train=0.6366 | val=0.5742 | 123.4s
[12:15:19]   Epoch  8/50 | train=0.6339 | val=0.5798 | 123.6s
[12:17:24]   Epoch  9/50 | train=0.6187 | val=0.5903 | 124.8s
[12:19:29]   Epoch 10/50 | train=0.6273 | val=0.5678 | 124.6s
[12:21:33]   Epoch 11/50 | train=0.6230 | val=0.5706 | 124.4s
[12:23:38]   Epoch 12/50 | train=0.6138 | val=0.5799 | 124.5s
[12:25:43]   Epoch 13/50 | train=0.6128 | val=0.5788 | 125.0s
[12:27:48]   Epoch 14/50 | train=0.6191 | val=0.5705 | 125.5s
[12:29:56]   Epoch 15/50 | train=0.6080 | val=0.5621 | 128.2s
[12:32:07]   Epoch 16/50 | train=0.5971 | val=0.5638 | 130.3s
[12:34:16]   Epoch 17/50 | train=0.6030 | val=0.5721 | 129.7s
[12:36:29]   Epoch 18/50 | train=0.5936 | val=0.6180 | 132.6s
[12:38:38]   Epoch 19/50 | train=0.5986 | val=0.5583 | 129.1s
[12:40:47]   Epoch 20/50 | train=0.5891 | val=0.5998 | 128.8s
[12:42:52]   Epoch 21/50 | train=0.5849 | val=0.5576 | 124.9s
[12:44:57]   Epoch 22/50 | train=0.5848 | val=0.5693 | 124.8s
[12:47:02]   Epoch 23/50 | train=0.5837 | val=0.5812 | 125.5s
[12:49:08]   Epoch 24/50 | train=0.5863 | val=0.5587 | 125.5s
[12:51:13]   Epoch 25/50 | train=0.5789 | val=0.5478 | 125.2s
[12:53:19]   Epoch 26/50 | train=0.5818 | val=0.5440 | 125.7s
[12:55:24]   Epoch 27/50 | train=0.5729 | val=0.5594 | 124.9s
[12:57:29]   Epoch 28/50 | train=0.5633 | val=0.5802 | 125.1s
[12:59:35]   Epoch 29/50 | train=0.5620 | val=0.5405 | 126.1s
[13:01:41]   Epoch 30/50 | train=0.5600 | val=0.5450 | 125.3s
[13:03:46]   Epoch 31/50 | train=0.5557 | val=0.5428 | 125.2s
[13:05:52]   Epoch 32/50 | train=0.5598 | val=0.5689 | 125.6s
[13:07:57]   Epoch 33/50 | train=0.5476 | val=0.5567 | 125.5s
[13:10:03]   Epoch 34/50 | train=0.5408 | val=0.5467 | 125.6s
[13:12:14]   Epoch 35/50 | train=0.5427 | val=0.5373 | 131.7s
[13:14:30]   Epoch 36/50 | train=0.5589 | val=0.5428 | 135.9s
[13:16:48]   Epoch 37/50 | train=0.5533 | val=0.5287 | 137.9s
[13:19:04]   Epoch 38/50 | train=0.5321 | val=0.6002 | 136.1s
[13:21:15]   Epoch 39/50 | train=0.5399 | val=0.5374 | 130.7s
[13:23:23]   Epoch 40/50 | train=0.5344 | val=0.5510 | 127.6s
[13:25:36]   Epoch 41/50 | train=0.5468 | val=0.6343 | 133.2s
[13:27:51]   Epoch 42/50 | train=0.5340 | val=0.5911 | 134.7s
[13:30:07]   Epoch 43/50 | train=0.5270 | val=0.5654 | 136.4s
[13:32:17]   Epoch 44/50 | train=0.5210 | val=0.5431 | 129.8s
[13:34:27]   Epoch 45/50 | train=0.5236 | val=0.5608 | 129.9s
[13:36:36]   Epoch 46/50 | train=0.5311 | val=0.5465 | 128.9s
[13:38:48]   Epoch 47/50 | train=0.5124 | val=0.5550 | 132.5s
[13:38:48]   Early stopping at epoch 47
[13:39:05]   Optimal threshold: 0.60 (val F1=0.878)
[13:39:11]   RESULTS: acc=0.982 | f1=0.991 | auc=nan | thresh=0.60
[13:39:11]            Sensitivity(MDD)=0.982 | Specificity(H)=0.000
[13:39:11]   Fold time: 102.2 min
[13:39:12] ======================================================================
[13:39:12] FOLD 16/40 — Test Subject: MDD_10
[13:39:12] ======================================================================
[13:40:27]   Sequences — Train: 4929, Val: 869, Test: 172
[13:40:27]   Class balance (train): H=1838, MDD=3091 | pos_weight=1.682
[13:40:27]   Data prep: 75.0s
[13:40:27]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[13:40:27]   Starting training...
[13:42:59]   Epoch  1/50 | train=0.8126 | val=0.7634 | 151.8s
[13:45:28]   Epoch  2/50 | train=0.7345 | val=0.6628 | 148.5s
[13:47:47]   Epoch  3/50 | train=0.6757 | val=0.6390 | 139.2s
[13:49:57]   Epoch  4/50 | train=0.6602 | val=0.6566 | 129.3s
[13:52:10]   Epoch  5/50 | train=0.6492 | val=0.7235 | 133.3s
[13:54:25]   Epoch  6/50 | train=0.6448 | val=0.7004 | 135.1s
[13:56:43]   Epoch  7/50 | train=0.6468 | val=0.6076 | 137.6s
[13:59:00]   Epoch  8/50 | train=0.6402 | val=0.7140 | 136.9s
[14:01:12]   Epoch  9/50 | train=0.6312 | val=0.6188 | 132.9s
[14:03:24]   Epoch 10/50 | train=0.6169 | val=0.6396 | 131.4s
[14:05:34]   Epoch 11/50 | train=0.6211 | val=0.6071 | 129.7s
[14:07:44]   Epoch 12/50 | train=0.6174 | val=0.6165 | 129.8s
[14:09:53]   Epoch 13/50 | train=0.6125 | val=0.6529 | 129.6s
[14:12:06]   Epoch 14/50 | train=0.6095 | val=0.6059 | 133.1s
[14:14:18]   Epoch 15/50 | train=0.6017 | val=0.6139 | 131.5s
[14:16:34]   Epoch 16/50 | train=0.5962 | val=0.6194 | 135.7s
[14:18:47]   Epoch 17/50 | train=0.5965 | val=0.6041 | 133.4s
[14:20:57]   Epoch 18/50 | train=0.6006 | val=0.6063 | 129.8s
[14:23:04]   Epoch 19/50 | train=0.5973 | val=0.6303 | 127.3s
[14:25:15]   Epoch 20/50 | train=0.5912 | val=0.6512 | 130.5s
[14:27:27]   Epoch 21/50 | train=0.5930 | val=0.6089 | 132.2s
[14:29:40]   Epoch 22/50 | train=0.5862 | val=0.5953 | 133.4s
[14:31:54]   Epoch 23/50 | train=0.5806 | val=0.6207 | 133.3s
[14:34:06]   Epoch 24/50 | train=0.5743 | val=0.6246 | 132.0s
[14:36:16]   Epoch 25/50 | train=0.5769 | val=0.6143 | 130.4s
[14:38:23]   Epoch 26/50 | train=0.5771 | val=0.6078 | 127.1s
[14:40:30]   Epoch 27/50 | train=0.5775 | val=0.6000 | 126.8s
[14:42:37]   Epoch 28/50 | train=0.5559 | val=0.6269 | 127.2s
[14:44:44]   Epoch 29/50 | train=0.5601 | val=0.6145 | 126.6s
[14:46:50]   Epoch 30/50 | train=0.5570 | val=0.5972 | 126.8s
[14:48:58]   Epoch 31/50 | train=0.5657 | val=0.6438 | 127.5s
[14:51:06]   Epoch 32/50 | train=0.5531 | val=0.6189 | 127.8s
[14:51:06]   Early stopping at epoch 32
[14:51:22]   Optimal threshold: 0.55 (val F1=0.863)
[14:51:33]   RESULTS: acc=0.977 | f1=0.988 | auc=nan | thresh=0.55
[14:51:33]            Sensitivity(MDD)=0.977 | Specificity(H)=0.000
[14:51:33]   Fold time: 72.3 min
[14:51:34] ======================================================================
[14:51:34] FOLD 17/40 — Test Subject: MDD_11
[14:51:34] ======================================================================
[14:52:45]   Sequences — Train: 4963, Val: 875, Test: 132
[14:52:45]   Class balance (train): H=1838, MDD=3125 | pos_weight=1.700
[14:52:45]   Data prep: 70.8s
[14:52:46]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[14:52:46]   Starting training...
[14:55:03]   Epoch  1/50 | train=0.8022 | val=0.7502 | 137.8s
[14:57:15]   Epoch  2/50 | train=0.7199 | val=0.5799 | 131.1s
[14:59:27]   Epoch  3/50 | train=0.6728 | val=0.6826 | 132.2s
[15:01:35]   Epoch  4/50 | train=0.6611 | val=0.6027 | 128.6s
[15:03:45]   Epoch  5/50 | train=0.6586 | val=0.5920 | 129.1s
[15:05:54]   Epoch  6/50 | train=0.6420 | val=0.5708 | 129.6s
[15:08:03]   Epoch  7/50 | train=0.6488 | val=0.6861 | 129.1s
[15:10:12]   Epoch  8/50 | train=0.6350 | val=0.5556 | 128.4s
[15:12:20]   Epoch  9/50 | train=0.6403 | val=0.5991 | 128.1s
[15:14:28]   Epoch 10/50 | train=0.6198 | val=0.6128 | 128.1s
[15:16:36]   Epoch 11/50 | train=0.6226 | val=0.6252 | 128.0s
[15:18:46]   Epoch 12/50 | train=0.6181 | val=0.5729 | 129.9s
[15:20:57]   Epoch 13/50 | train=0.6268 | val=0.6066 | 130.5s
[15:23:07]   Epoch 14/50 | train=0.6150 | val=0.5505 | 130.3s
[15:25:15]   Epoch 15/50 | train=0.6039 | val=0.5529 | 128.0s
[15:27:22]   Epoch 16/50 | train=0.6113 | val=0.5837 | 127.2s
[15:29:30]   Epoch 17/50 | train=0.6064 | val=0.5771 | 127.6s
[15:31:37]   Epoch 18/50 | train=0.6039 | val=0.5510 | 127.5s
[15:33:45]   Epoch 19/50 | train=0.6052 | val=0.5850 | 127.3s
[15:35:52]   Epoch 20/50 | train=0.5964 | val=0.5508 | 127.0s
[15:38:00]   Epoch 21/50 | train=0.5895 | val=0.5577 | 127.9s
[15:40:07]   Epoch 22/50 | train=0.5887 | val=0.5363 | 127.4s
[15:42:15]   Epoch 23/50 | train=0.5889 | val=0.5864 | 127.6s
[15:44:23]   Epoch 24/50 | train=0.5803 | val=0.5721 | 128.0s
[15:46:30]   Epoch 25/50 | train=0.5898 | val=0.5352 | 127.6s
[15:48:39]   Epoch 26/50 | train=0.5831 | val=0.5425 | 128.2s
[15:50:47]   Epoch 27/50 | train=0.5784 | val=0.5321 | 128.8s
[15:52:56]   Epoch 28/50 | train=0.5721 | val=0.5789 | 128.5s
[15:55:05]   Epoch 29/50 | train=0.5789 | val=0.5591 | 128.7s
[15:57:13]   Epoch 30/50 | train=0.5670 | val=0.5822 | 128.5s
[15:59:23]   Epoch 31/50 | train=0.5647 | val=0.5592 | 129.3s
[16:01:31]   Epoch 32/50 | train=0.5606 | val=0.5499 | 128.3s
[16:03:39]   Epoch 33/50 | train=0.5683 | val=0.5397 | 128.4s
[16:05:48]   Epoch 34/50 | train=0.5589 | val=0.5495 | 128.9s
[16:07:57]   Epoch 35/50 | train=0.5615 | val=0.5600 | 129.1s
[16:10:06]   Epoch 36/50 | train=0.5599 | val=0.5324 | 128.8s
[16:12:15]   Epoch 37/50 | train=0.5504 | val=0.5346 | 128.7s
[16:12:15]   Early stopping at epoch 37
[16:12:31]   Optimal threshold: 0.60 (val F1=0.879)
[16:12:34]   RESULTS: acc=1.000 | f1=1.000 | auc=nan | thresh=0.60
[16:12:34]            Sensitivity(MDD)=1.000 | Specificity(H)=0.000
[16:12:34]   Fold time: 81.0 min
[16:12:35] ======================================================================
[16:12:35] FOLD 18/40 — Test Subject: MDD_13
[16:12:35] ======================================================================
[16:13:45]   Sequences — Train: 4992, Val: 880, Test: 98
[16:13:45]   Class balance (train): H=1838, MDD=3154 | pos_weight=1.716
[16:13:45]   Data prep: 69.9s
[16:13:46]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[16:13:46]   Starting training...
[16:15:48]   Epoch  1/50 | train=0.8074 | val=0.7756 | 122.1s
[16:18:03]   Epoch  2/50 | train=0.7278 | val=0.6622 | 135.5s
[16:20:22]   Epoch  3/50 | train=0.6693 | val=0.7096 | 138.5s
[16:22:35]   Epoch  4/50 | train=0.6606 | val=0.6651 | 133.3s
[16:24:50]   Epoch  5/50 | train=0.6484 | val=0.6804 | 134.4s
[16:27:04]   Epoch  6/50 | train=0.6345 | val=0.7103 | 134.6s
[16:29:19]   Epoch  7/50 | train=0.6264 | val=0.7264 | 134.6s
[16:31:33]   Epoch  8/50 | train=0.6301 | val=0.6603 | 134.6s
[16:33:49]   Epoch  9/50 | train=0.6180 | val=0.6777 | 134.9s
[16:36:04]   Epoch 10/50 | train=0.6153 | val=0.6713 | 135.3s
[16:38:19]   Epoch 11/50 | train=0.6010 | val=0.7730 | 135.5s
[16:40:35]   Epoch 12/50 | train=0.6067 | val=0.7147 | 136.0s
[16:42:52]   Epoch 13/50 | train=0.5907 | val=0.6638 | 136.5s
[16:45:09]   Epoch 14/50 | train=0.5996 | val=0.6456 | 136.8s
[16:47:26]   Epoch 15/50 | train=0.5883 | val=0.6762 | 137.4s
[16:49:42]   Epoch 16/50 | train=0.5935 | val=0.6782 | 135.7s
[16:51:57]   Epoch 17/50 | train=0.5915 | val=0.6545 | 135.5s
[16:54:13]   Epoch 18/50 | train=0.5866 | val=0.6833 | 135.8s
[16:56:29]   Epoch 19/50 | train=0.5781 | val=0.6466 | 135.6s
[16:58:46]   Epoch 20/50 | train=0.5852 | val=0.6429 | 136.8s
[17:01:02]   Epoch 21/50 | train=0.5739 | val=0.6729 | 136.4s
[17:03:19]   Epoch 22/50 | train=0.5804 | val=0.6625 | 136.4s
[17:05:35]   Epoch 23/50 | train=0.5657 | val=0.6546 | 136.1s
[17:07:52]   Epoch 24/50 | train=0.5678 | val=0.6402 | 137.8s
[17:10:09]   Epoch 25/50 | train=0.5719 | val=0.6458 | 136.3s
[17:12:25]   Epoch 26/50 | train=0.5605 | val=0.6732 | 136.3s
[17:14:45]   Epoch 27/50 | train=0.5610 | val=0.6773 | 139.8s
[17:17:11]   Epoch 28/50 | train=0.5745 | val=0.8032 | 145.6s
[17:19:33]   Epoch 29/50 | train=0.5586 | val=0.6503 | 142.2s
[17:21:53]   Epoch 30/50 | train=0.5602 | val=0.7420 | 140.7s
[17:24:18]   Epoch 31/50 | train=0.5556 | val=0.6504 | 144.1s
[17:26:40]   Epoch 32/50 | train=0.5530 | val=0.6619 | 142.6s
[17:29:01]   Epoch 33/50 | train=0.5490 | val=0.6790 | 140.7s
[17:31:18]   Epoch 34/50 | train=0.5514 | val=0.6543 | 137.3s
[17:31:18]   Early stopping at epoch 34
[17:31:36]   Optimal threshold: 0.65 (val F1=0.846)
[17:31:39]   RESULTS: acc=0.949 | f1=0.974 | auc=nan | thresh=0.65
[17:31:39]            Sensitivity(MDD)=0.949 | Specificity(H)=0.000
[17:31:39]   Fold time: 79.1 min
[17:31:40] ======================================================================
[17:31:40] FOLD 19/40 — Test Subject: MDD_14
[17:31:40] ======================================================================
[17:32:50]   Sequences — Train: 4994, Val: 880, Test: 96
[17:32:50]   Class balance (train): H=1838, MDD=3156 | pos_weight=1.717
[17:32:50]   Data prep: 69.7s
[17:32:50]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[17:32:50]   Starting training...
[17:35:06]   Epoch  1/50 | train=0.8087 | val=0.7682 | 136.2s
[17:37:33]   Epoch  2/50 | train=0.7210 | val=0.6386 | 146.2s
[17:40:12]   Epoch  3/50 | train=0.6803 | val=0.6156 | 159.3s
[17:42:49]   Epoch  4/50 | train=0.6619 | val=0.6031 | 156.4s
[17:45:22]   Epoch  5/50 | train=0.6498 | val=0.6738 | 153.2s
[17:47:45]   Epoch  6/50 | train=0.6451 | val=0.5895 | 143.5s
[17:50:04]   Epoch  7/50 | train=0.6416 | val=0.6310 | 138.5s
[17:52:23]   Epoch  8/50 | train=0.6286 | val=0.5994 | 138.6s
[17:54:41]   Epoch  9/50 | train=0.6295 | val=0.6123 | 138.1s
[17:56:59]   Epoch 10/50 | train=0.6211 | val=0.6039 | 138.8s
[17:59:18]   Epoch 11/50 | train=0.6158 | val=0.6320 | 139.0s
[18:01:36]   Epoch 12/50 | train=0.6233 | val=0.6630 | 137.4s
[18:04:03]   Epoch 13/50 | train=0.6043 | val=0.6086 | 147.5s
[18:06:37]   Epoch 14/50 | train=0.6063 | val=0.6263 | 153.7s
[18:09:07]   Epoch 15/50 | train=0.6002 | val=0.5917 | 149.8s
[18:11:32]   Epoch 16/50 | train=0.6071 | val=0.5966 | 145.3s
[18:11:32]   Early stopping at epoch 16
[18:11:51]   Optimal threshold: 0.55 (val F1=0.860)
[18:11:53]   RESULTS: acc=0.958 | f1=0.979 | auc=nan | thresh=0.55
[18:11:53]            Sensitivity(MDD)=0.958 | Specificity(H)=0.000
[18:11:53]   Fold time: 40.2 min
[18:11:54] ======================================================================
[18:11:54] FOLD 20/40 — Test Subject: MDD_15
[18:11:54] ======================================================================
[18:13:03]   Sequences — Train: 4944, Val: 872, Test: 154
[18:13:03]   Class balance (train): H=1838, MDD=3106 | pos_weight=1.690
[18:13:04]   Data prep: 69.2s
[18:13:04]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[18:13:04]   Starting training...
[18:15:17]   Epoch  1/50 | train=0.8047 | val=0.7781 | 132.5s
[18:17:39]   Epoch  2/50 | train=0.7086 | val=0.8550 | 142.4s
[18:20:02]   Epoch  3/50 | train=0.6682 | val=0.6613 | 142.3s
[18:22:33]   Epoch  4/50 | train=0.6579 | val=0.7194 | 151.1s
[18:25:03]   Epoch  5/50 | train=0.6511 | val=0.7417 | 150.2s
[18:27:27]   Epoch  6/50 | train=0.6441 | val=0.6964 | 144.4s
[18:29:49]   Epoch  7/50 | train=0.6275 | val=0.6809 | 141.9s
[18:32:11]   Epoch  8/50 | train=0.6262 | val=0.7021 | 141.5s
[18:34:33]   Epoch  9/50 | train=0.6239 | val=0.6861 | 142.5s
[18:36:50]   Epoch 10/50 | train=0.6175 | val=0.6581 | 137.4s
[18:39:07]   Epoch 11/50 | train=0.6152 | val=0.6512 | 136.7s
[18:41:24]   Epoch 12/50 | train=0.6142 | val=0.6777 | 136.6s
[18:43:39]   Epoch 13/50 | train=0.6020 | val=0.6631 | 135.1s
[18:45:52]   Epoch 14/50 | train=0.6053 | val=0.6455 | 133.1s
[18:48:04]   Epoch 15/50 | train=0.5901 | val=0.7007 | 131.6s
[18:50:15]   Epoch 16/50 | train=0.5888 | val=0.6488 | 131.3s
[18:52:27]   Epoch 17/50 | train=0.5926 | val=0.6664 | 131.5s
[18:54:38]   Epoch 18/50 | train=0.5808 | val=0.7404 | 130.8s
[18:56:49]   Epoch 19/50 | train=0.5861 | val=0.6599 | 131.0s
[18:59:01]   Epoch 20/50 | train=0.5795 | val=0.6800 | 132.2s
[19:01:12]   Epoch 21/50 | train=0.5778 | val=0.6875 | 131.1s
[19:03:23]   Epoch 22/50 | train=0.5734 | val=0.6959 | 131.2s
[19:05:34]   Epoch 23/50 | train=0.5765 | val=0.6978 | 130.9s
[19:07:46]   Epoch 24/50 | train=0.5693 | val=0.6546 | 131.5s
[19:07:46]   Early stopping at epoch 24
[19:08:03]   Optimal threshold: 0.45 (val F1=0.840)
[19:08:11]   RESULTS: acc=0.994 | f1=0.997 | auc=nan | thresh=0.45
[19:08:11]            Sensitivity(MDD)=0.994 | Specificity(H)=0.000
[19:08:11]   Fold time: 56.3 min
[19:08:12] ======================================================================
[19:08:12] FOLD 21/40 — Test Subject: MDD_17
[19:08:12] ======================================================================
[19:09:21]   Sequences — Train: 4927, Val: 869, Test: 174
[19:09:21]   Class balance (train): H=1838, MDD=3089 | pos_weight=1.681
[19:09:21]   Data prep: 69.0s
[19:09:22]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[19:09:22]   Starting training...
[19:11:56]   Epoch  1/50 | train=0.8022 | val=0.7144 | 154.1s
[19:14:07]   Epoch  2/50 | train=0.7077 | val=0.6528 | 130.6s
[19:16:21]   Epoch  3/50 | train=0.6730 | val=0.6073 | 134.5s
[19:18:34]   Epoch  4/50 | train=0.6625 | val=0.6246 | 133.0s
[19:20:47]   Epoch  5/50 | train=0.6418 | val=0.5683 | 132.7s
[19:22:59]   Epoch  6/50 | train=0.6415 | val=0.5742 | 131.7s
[19:25:10]   Epoch  7/50 | train=0.6333 | val=0.5691 | 131.3s
[19:27:22]   Epoch  8/50 | train=0.6252 | val=0.5728 | 131.8s
[19:29:34]   Epoch  9/50 | train=0.6182 | val=0.5751 | 131.6s
[19:31:45]   Epoch 10/50 | train=0.6318 | val=0.5771 | 131.6s
[19:33:58]   Epoch 11/50 | train=0.6218 | val=0.5629 | 132.6s
[19:36:09]   Epoch 12/50 | train=0.6112 | val=0.5847 | 130.9s
[19:38:20]   Epoch 13/50 | train=0.6045 | val=0.6097 | 131.4s
[19:40:32]   Epoch 14/50 | train=0.6123 | val=0.5568 | 131.5s
[19:42:43]   Epoch 15/50 | train=0.6137 | val=0.5708 | 130.9s
[19:44:53]   Epoch 16/50 | train=0.6051 | val=0.5750 | 130.8s
[19:47:04]   Epoch 17/50 | train=0.5947 | val=0.5588 | 130.9s
[19:49:16]   Epoch 18/50 | train=0.5976 | val=0.5647 | 131.2s
[19:51:26]   Epoch 19/50 | train=0.5934 | val=0.5731 | 130.8s
[19:53:37]   Epoch 20/50 | train=0.5923 | val=0.5718 | 131.0s
[19:55:48]   Epoch 21/50 | train=0.5844 | val=0.5865 | 130.7s
[19:57:59]   Epoch 22/50 | train=0.5819 | val=0.5854 | 130.8s
[20:00:11]   Epoch 23/50 | train=0.5764 | val=0.5596 | 131.7s
[20:02:21]   Epoch 24/50 | train=0.5752 | val=0.5645 | 130.8s
[20:02:21]   Early stopping at epoch 24
[20:02:38]   Optimal threshold: 0.45 (val F1=0.867)
[20:02:46]   RESULTS: acc=0.977 | f1=0.988 | auc=nan | thresh=0.45
[20:02:46]            Sensitivity(MDD)=0.977 | Specificity(H)=0.000
[20:02:46]   Fold time: 54.6 min
[20:02:48] ======================================================================
[20:02:48] FOLD 22/40 — Test Subject: MDD_18
[20:02:48] ======================================================================
[20:04:00]   Sequences — Train: 4938, Val: 871, Test: 161
[20:04:00]   Class balance (train): H=1838, MDD=3100 | pos_weight=1.687
[20:04:00]   Data prep: 72.7s
[20:04:01]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[20:04:01]   Starting training...
[20:06:29]   Epoch  1/50 | train=0.8117 | val=0.7812 | 148.6s
[20:08:38]   Epoch  2/50 | train=0.7238 | val=0.7103 | 128.7s
[20:10:51]   Epoch  3/50 | train=0.6864 | val=0.6384 | 132.8s
[20:13:04]   Epoch  4/50 | train=0.6553 | val=0.6685 | 132.5s
[20:15:15]   Epoch  5/50 | train=0.6449 | val=0.6605 | 131.6s
[20:17:27]   Epoch  6/50 | train=0.6337 | val=0.7470 | 131.4s
[20:19:38]   Epoch  7/50 | train=0.6252 | val=0.6064 | 131.2s
[20:21:49]   Epoch  8/50 | train=0.6191 | val=0.6186 | 131.0s
[20:24:00]   Epoch  9/50 | train=0.6378 | val=0.5972 | 131.1s
[20:26:11]   Epoch 10/50 | train=0.6153 | val=0.6685 | 130.6s
[20:28:21]   Epoch 11/50 | train=0.6092 | val=0.6663 | 130.7s
[20:30:32]   Epoch 12/50 | train=0.6180 | val=0.6496 | 130.6s
[20:32:43]   Epoch 13/50 | train=0.6019 | val=0.6217 | 131.0s
[20:34:54]   Epoch 14/50 | train=0.6029 | val=0.6535 | 130.6s
[20:37:05]   Epoch 15/50 | train=0.6018 | val=0.6282 | 131.0s
[20:39:16]   Epoch 16/50 | train=0.5919 | val=0.6195 | 131.0s
[20:41:26]   Epoch 17/50 | train=0.5891 | val=0.6431 | 130.4s
[20:43:37]   Epoch 18/50 | train=0.5868 | val=0.6049 | 130.6s
[20:45:48]   Epoch 19/50 | train=0.5887 | val=0.6858 | 131.2s
[20:45:48]   Early stopping at epoch 19
[20:46:05]   Optimal threshold: 0.65 (val F1=0.857)
[20:46:09]   RESULTS: acc=0.950 | f1=0.975 | auc=nan | thresh=0.65
[20:46:09]            Sensitivity(MDD)=0.950 | Specificity(H)=0.000
[20:46:09]   Fold time: 43.4 min
[20:46:10] ======================================================================
[20:46:10] FOLD 23/40 — Test Subject: MDD_19
[20:46:10] ======================================================================
[20:47:16]   Sequences — Train: 4931, Val: 869, Test: 170
[20:47:16]   Class balance (train): H=1838, MDD=3093 | pos_weight=1.683
[20:47:16]   Data prep: 66.3s
[20:47:18]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[20:47:18]   Starting training...
[20:49:26]   Epoch  1/50 | train=0.8007 | val=0.7151 | 128.7s
[20:51:37]   Epoch  2/50 | train=0.6882 | val=0.6468 | 130.7s
[20:53:53]   Epoch  3/50 | train=0.6369 | val=0.5510 | 136.0s
[20:56:05]   Epoch  4/50 | train=0.6238 | val=0.5686 | 131.3s
[20:58:16]   Epoch  5/50 | train=0.6098 | val=0.5399 | 131.8s
[21:00:29]   Epoch  6/50 | train=0.6076 | val=0.6589 | 132.0s
[21:02:39]   Epoch  7/50 | train=0.5973 | val=0.5501 | 130.8s
[21:04:50]   Epoch  8/50 | train=0.5956 | val=0.5421 | 130.7s
[21:07:01]   Epoch  9/50 | train=0.5848 | val=0.5242 | 131.2s
[21:09:12]   Epoch 10/50 | train=0.5797 | val=0.5676 | 130.3s
[21:11:22]   Epoch 11/50 | train=0.5772 | val=0.5181 | 130.2s
[21:13:32]   Epoch 12/50 | train=0.5849 | val=0.5299 | 130.2s
[21:15:43]   Epoch 13/50 | train=0.5734 | val=0.5599 | 130.3s
[21:17:53]   Epoch 14/50 | train=0.5655 | val=0.5252 | 130.1s
[21:20:03]   Epoch 15/50 | train=0.5612 | val=0.5301 | 130.4s
[21:22:14]   Epoch 16/50 | train=0.5537 | val=0.5552 | 130.5s
[21:24:24]   Epoch 17/50 | train=0.5682 | val=0.5504 | 130.5s
[21:26:34]   Epoch 18/50 | train=0.5549 | val=0.5243 | 130.3s
[21:28:45]   Epoch 19/50 | train=0.5492 | val=0.5151 | 130.4s
[21:30:55]   Epoch 20/50 | train=0.5575 | val=0.5028 | 129.9s
[21:33:06]   Epoch 21/50 | train=0.5481 | val=0.5120 | 130.6s
[21:35:16]   Epoch 22/50 | train=0.5457 | val=0.5049 | 130.4s
[21:37:26]   Epoch 23/50 | train=0.5462 | val=0.5015 | 130.3s
[21:39:36]   Epoch 24/50 | train=0.5331 | val=0.5388 | 130.0s
[21:41:47]   Epoch 25/50 | train=0.5397 | val=0.4962 | 130.3s
[21:43:57]   Epoch 26/50 | train=0.5318 | val=0.5189 | 130.3s
[21:46:07]   Epoch 27/50 | train=0.5183 | val=0.5017 | 130.1s
[21:48:18]   Epoch 28/50 | train=0.5310 | val=0.5062 | 130.4s
[21:50:28]   Epoch 29/50 | train=0.5301 | val=0.5013 | 130.1s
[21:52:38]   Epoch 30/50 | train=0.5221 | val=0.5299 | 130.5s
[21:54:49]   Epoch 31/50 | train=0.5149 | val=0.4881 | 130.7s
[21:56:59]   Epoch 32/50 | train=0.5158 | val=0.5403 | 130.1s
[21:59:12]   Epoch 33/50 | train=0.5034 | val=0.5130 | 132.6s
[22:01:23]   Epoch 34/50 | train=0.5001 | val=0.4858 | 130.9s
[22:03:33]   Epoch 35/50 | train=0.4963 | val=0.5044 | 130.4s
[22:05:43]   Epoch 36/50 | train=0.5006 | val=0.5360 | 130.3s
[22:07:54]   Epoch 37/50 | train=0.5038 | val=0.4908 | 131.0s
[22:10:06]   Epoch 38/50 | train=0.5011 | val=0.4963 | 131.9s
[22:12:20]   Epoch 39/50 | train=0.4996 | val=0.5015 | 133.6s
[22:14:30]   Epoch 40/50 | train=0.4820 | val=0.5109 | 130.7s
[22:16:41]   Epoch 41/50 | train=0.4908 | val=0.4888 | 131.0s
[22:18:53]   Epoch 42/50 | train=0.4784 | val=0.4814 | 131.4s
[22:21:04]   Epoch 43/50 | train=0.4843 | val=0.4957 | 130.7s
[22:23:14]   Epoch 44/50 | train=0.4866 | val=0.4924 | 130.6s
[22:25:25]   Epoch 45/50 | train=0.4840 | val=0.4897 | 130.5s
[22:27:35]   Epoch 46/50 | train=0.4841 | val=0.5108 | 130.3s
[22:29:46]   Epoch 47/50 | train=0.4629 | val=0.4882 | 130.6s
[22:31:56]   Epoch 48/50 | train=0.4740 | val=0.4977 | 130.4s
[22:34:06]   Epoch 49/50 | train=0.4678 | val=0.5194 | 130.2s
[22:36:17]   Epoch 50/50 | train=0.4591 | val=0.5111 | 130.6s
[22:36:34]   Optimal threshold: 0.75 (val F1=0.893)
[22:36:45]   RESULTS: acc=0.165 | f1=0.283 | auc=nan | thresh=0.75
[22:36:45]            Sensitivity(MDD)=0.165 | Specificity(H)=0.000
[22:36:45]   Fold time: 110.6 min
[22:36:46] ======================================================================
[22:36:46] FOLD 24/40 — Test Subject: MDD_2
[22:36:46] ======================================================================
[22:37:56]   Sequences — Train: 4930, Val: 869, Test: 171
[22:37:56]   Class balance (train): H=1838, MDD=3092 | pos_weight=1.682
[22:37:56]   Data prep: 69.8s
[22:37:56]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[22:37:56]   Starting training...
[22:40:19]   Epoch  1/50 | train=0.8050 | val=0.7220 | 142.9s
[22:42:35]   Epoch  2/50 | train=0.7110 | val=0.6724 | 135.4s
[22:44:53]   Epoch  3/50 | train=0.6685 | val=0.6372 | 137.9s
[22:47:06]   Epoch  4/50 | train=0.6522 | val=0.6678 | 133.0s
[22:49:18]   Epoch  5/50 | train=0.6435 | val=0.6410 | 132.4s
[22:51:30]   Epoch  6/50 | train=0.6328 | val=0.6074 | 131.8s
[22:53:42]   Epoch  7/50 | train=0.6261 | val=0.6196 | 132.3s
[22:55:54]   Epoch  8/50 | train=0.6318 | val=0.6189 | 131.2s
[22:58:05]   Epoch  9/50 | train=0.6142 | val=0.7005 | 130.8s
[23:00:17]   Epoch 10/50 | train=0.6216 | val=0.6566 | 132.1s
[23:02:27]   Epoch 11/50 | train=0.6258 | val=0.6821 | 130.6s
[23:04:38]   Epoch 12/50 | train=0.6071 | val=0.6209 | 130.7s
[23:06:50]   Epoch 13/50 | train=0.6078 | val=0.6161 | 131.8s
[23:09:00]   Epoch 14/50 | train=0.6030 | val=0.6282 | 130.5s
[23:11:11]   Epoch 15/50 | train=0.6027 | val=0.6230 | 130.4s
[23:13:21]   Epoch 16/50 | train=0.5922 | val=0.7204 | 130.2s
[23:13:21]   Early stopping at epoch 16
[23:13:38]   Optimal threshold: 0.60 (val F1=0.847)
[23:13:43]   RESULTS: acc=0.947 | f1=0.973 | auc=nan | thresh=0.60
[23:13:43]            Sensitivity(MDD)=0.947 | Specificity(H)=0.000
[23:13:43]   Fold time: 37.0 min
[23:13:45] ======================================================================
[23:13:45] FOLD 25/40 — Test Subject: MDD_20
[23:13:45] ======================================================================
[23:14:50]   Sequences — Train: 4938, Val: 871, Test: 161
[23:14:50]   Class balance (train): H=1838, MDD=3100 | pos_weight=1.687
[23:14:50]   Data prep: 65.1s
[23:14:51]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[23:14:51]   Starting training...
[23:17:21]   Epoch  1/50 | train=0.8025 | val=0.6998 | 150.1s
[23:19:29]   Epoch  2/50 | train=0.7246 | val=0.6455 | 128.1s
[23:21:40]   Epoch  3/50 | train=0.6753 | val=0.7528 | 131.0s
[23:23:54]   Epoch  4/50 | train=0.6573 | val=0.6453 | 133.7s
[23:26:07]   Epoch  5/50 | train=0.6459 | val=0.6788 | 132.8s
[23:28:21]   Epoch  6/50 | train=0.6291 | val=0.6410 | 134.2s
[23:30:36]   Epoch  7/50 | train=0.6297 | val=0.6387 | 135.2s
[23:32:54]   Epoch  8/50 | train=0.6271 | val=0.6428 | 137.7s
[23:35:05]   Epoch  9/50 | train=0.6200 | val=0.6234 | 130.6s
[23:37:17]   Epoch 10/50 | train=0.6217 | val=0.6460 | 131.9s
[23:39:26]   Epoch 11/50 | train=0.6137 | val=0.6220 | 129.7s
[23:41:37]   Epoch 12/50 | train=0.6144 | val=0.6685 | 130.0s
[23:43:50]   Epoch 13/50 | train=0.6141 | val=0.6192 | 133.4s
[23:46:04]   Epoch 14/50 | train=0.6145 | val=0.6151 | 133.6s
[23:48:18]   Epoch 15/50 | train=0.6029 | val=0.6037 | 133.8s
[23:50:34]   Epoch 16/50 | train=0.5999 | val=0.6223 | 136.0s
[23:52:44]   Epoch 17/50 | train=0.5982 | val=0.6258 | 130.7s
[23:54:52]   Epoch 18/50 | train=0.5848 | val=0.6554 | 127.5s
[23:56:58]   Epoch 19/50 | train=0.5895 | val=0.6181 | 125.8s
[23:59:07]   Epoch 20/50 | train=0.5900 | val=0.6215 | 128.9s
[00:01:14]   Epoch 21/50 | train=0.5873 | val=0.6183 | 127.1s
[00:03:19]   Epoch 22/50 | train=0.5766 | val=0.6389 | 125.2s
[00:05:24]   Epoch 23/50 | train=0.5723 | val=0.6150 | 124.8s
[00:07:29]   Epoch 24/50 | train=0.5783 | val=0.6564 | 125.0s
[00:09:33]   Epoch 25/50 | train=0.5783 | val=0.6411 | 124.0s
[00:09:33]   Early stopping at epoch 25
[00:09:49]   Optimal threshold: 0.40 (val F1=0.857)
[00:09:52]   RESULTS: acc=0.988 | f1=0.994 | auc=nan | thresh=0.40
[00:09:52]            Sensitivity(MDD)=0.988 | Specificity(H)=0.000
[00:09:52]   Fold time: 56.1 min
[00:09:54] ======================================================================
[00:09:54] FOLD 26/40 — Test Subject: MDD_21
[00:09:54] ======================================================================
[00:11:06]   Sequences — Train: 4956, Val: 874, Test: 140
[00:11:06]   Class balance (train): H=1838, MDD=3118 | pos_weight=1.696
[00:11:06]   Data prep: 72.8s
[00:11:07]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[00:11:07]   Starting training...
[00:13:38]   Epoch  1/50 | train=0.8028 | val=0.7453 | 151.2s
[00:15:48]   Epoch  2/50 | train=0.7077 | val=0.7874 | 130.3s
[00:18:04]   Epoch  3/50 | train=0.6675 | val=0.6753 | 135.7s
[00:20:19]   Epoch  4/50 | train=0.6560 | val=0.6596 | 134.5s
[00:22:32]   Epoch  5/50 | train=0.6421 | val=0.6448 | 132.9s
[00:24:42]   Epoch  6/50 | train=0.6348 | val=0.7464 | 130.3s
[00:26:56]   Epoch  7/50 | train=0.6350 | val=0.6692 | 133.5s
[00:29:11]   Epoch  8/50 | train=0.6195 | val=0.6569 | 135.7s
[00:31:29]   Epoch  9/50 | train=0.6171 | val=0.6698 | 137.5s
[00:33:44]   Epoch 10/50 | train=0.6148 | val=0.6584 | 134.9s
[00:35:54]   Epoch 11/50 | train=0.6124 | val=0.6601 | 130.5s
[00:38:02]   Epoch 12/50 | train=0.6128 | val=0.6961 | 128.2s
[00:40:09]   Epoch 13/50 | train=0.6058 | val=0.6801 | 126.3s
[00:42:16]   Epoch 14/50 | train=0.6005 | val=0.6488 | 126.8s
[00:44:22]   Epoch 15/50 | train=0.6019 | val=0.6883 | 126.7s
[00:44:22]   Early stopping at epoch 15
[00:44:39]   Optimal threshold: 0.45 (val F1=0.844)
[00:44:42]   RESULTS: acc=0.936 | f1=0.967 | auc=nan | thresh=0.45
[00:44:42]            Sensitivity(MDD)=0.936 | Specificity(H)=0.000
[00:44:42]   Fold time: 34.8 min
[00:44:44] ======================================================================
[00:44:44] FOLD 27/40 — Test Subject: MDD_22
[00:44:44] ======================================================================
[00:45:56]   Sequences — Train: 4950, Val: 873, Test: 147
[00:45:56]   Class balance (train): H=1838, MDD=3112 | pos_weight=1.693
[00:45:56]   Data prep: 72.5s
[00:45:57]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[00:45:57]   Starting training...
[00:48:18]   Epoch  1/50 | train=0.7985 | val=0.7185 | 140.9s
[00:50:29]   Epoch  2/50 | train=0.7117 | val=0.6879 | 131.0s
[00:52:39]   Epoch  3/50 | train=0.6815 | val=0.6515 | 130.1s
[00:54:45]   Epoch  4/50 | train=0.6585 | val=0.7285 | 126.2s
[00:56:51]   Epoch  5/50 | train=0.6529 | val=0.6937 | 126.0s
[00:58:58]   Epoch  6/50 | train=0.6384 | val=0.6690 | 126.7s
[01:01:04]   Epoch  7/50 | train=0.6347 | val=0.6511 | 125.6s
[01:03:09]   Epoch  8/50 | train=0.6299 | val=0.6391 | 125.3s
[01:05:15]   Epoch  9/50 | train=0.6158 | val=0.6817 | 125.4s
[01:07:20]   Epoch 10/50 | train=0.6210 | val=0.6315 | 125.6s
[01:09:26]   Epoch 11/50 | train=0.6219 | val=0.6544 | 125.4s
[01:11:31]   Epoch 12/50 | train=0.6133 | val=0.6166 | 124.8s
[01:13:36]   Epoch 13/50 | train=0.6055 | val=0.6675 | 125.6s
[01:15:43]   Epoch 14/50 | train=0.6134 | val=0.6683 | 126.2s
[01:17:48]   Epoch 15/50 | train=0.6123 | val=0.7438 | 125.8s
[01:19:54]   Epoch 16/50 | train=0.6025 | val=0.6781 | 125.3s
[01:21:59]   Epoch 17/50 | train=0.6015 | val=0.6349 | 125.3s
[01:24:04]   Epoch 18/50 | train=0.5957 | val=0.6526 | 124.9s
[01:26:09]   Epoch 19/50 | train=0.5874 | val=0.6222 | 125.3s
[01:28:14]   Epoch 20/50 | train=0.5840 | val=0.6078 | 125.1s
[01:30:20]   Epoch 21/50 | train=0.5844 | val=0.6166 | 125.3s
[01:32:25]   Epoch 22/50 | train=0.5787 | val=0.6406 | 125.0s
[01:34:30]   Epoch 23/50 | train=0.5758 | val=0.6539 | 125.1s
[01:36:35]   Epoch 24/50 | train=0.5759 | val=0.6218 | 125.0s
[01:38:40]   Epoch 25/50 | train=0.5713 | val=0.6441 | 124.8s
[01:40:45]   Epoch 26/50 | train=0.5761 | val=0.6075 | 125.1s
[01:42:50]   Epoch 27/50 | train=0.5777 | val=0.6249 | 124.9s
[01:44:55]   Epoch 28/50 | train=0.5685 | val=0.6228 | 125.2s
[01:47:01]   Epoch 29/50 | train=0.5618 | val=0.6440 | 126.0s
[01:49:06]   Epoch 30/50 | train=0.5607 | val=0.6141 | 125.0s
[01:51:11]   Epoch 31/50 | train=0.5598 | val=0.6108 | 125.2s
[01:53:16]   Epoch 32/50 | train=0.5534 | val=0.5902 | 125.1s
[01:55:22]   Epoch 33/50 | train=0.5560 | val=0.6280 | 125.2s
[01:57:27]   Epoch 34/50 | train=0.5420 | val=0.6352 | 125.1s
[01:59:32]   Epoch 35/50 | train=0.5477 | val=0.6044 | 125.6s
[02:01:37]   Epoch 36/50 | train=0.5360 | val=0.6338 | 125.2s
[02:03:43]   Epoch 37/50 | train=0.5444 | val=0.6860 | 125.4s
[02:05:48]   Epoch 38/50 | train=0.5263 | val=0.6277 | 125.3s
[02:07:54]   Epoch 39/50 | train=0.5414 | val=0.6023 | 126.2s
[02:10:00]   Epoch 40/50 | train=0.5424 | val=0.6517 | 125.3s
[02:12:05]   Epoch 41/50 | train=0.5372 | val=0.6025 | 125.2s
[02:14:10]   Epoch 42/50 | train=0.5198 | val=0.6187 | 125.3s
[02:14:10]   Early stopping at epoch 42
[02:14:26]   Optimal threshold: 0.70 (val F1=0.857)
[02:14:29]   RESULTS: acc=0.959 | f1=0.979 | auc=nan | thresh=0.70
[02:14:29]            Sensitivity(MDD)=0.959 | Specificity(H)=0.000
[02:14:29]   Fold time: 89.8 min
[02:14:31] ======================================================================
[02:14:31] FOLD 28/40 — Test Subject: MDD_23
[02:14:31] ======================================================================
[02:15:39]   Sequences — Train: 4967, Val: 876, Test: 127
[02:15:39]   Class balance (train): H=1838, MDD=3129 | pos_weight=1.702
[02:15:39]   Data prep: 68.1s
[02:15:39]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[02:15:39]   Starting training...
[02:18:02]   Epoch  1/50 | train=0.8053 | val=0.7220 | 143.3s
[02:20:08]   Epoch  2/50 | train=0.7214 | val=0.6118 | 126.0s
[02:22:17]   Epoch  3/50 | train=0.6746 | val=0.6104 | 128.0s
[02:24:24]   Epoch  4/50 | train=0.6556 | val=0.5996 | 127.0s
[02:26:30]   Epoch  5/50 | train=0.6514 | val=0.5972 | 126.6s
[02:28:37]   Epoch  6/50 | train=0.6333 | val=0.6096 | 126.7s
[02:30:44]   Epoch  7/50 | train=0.6427 | val=0.5860 | 126.7s
[02:32:50]   Epoch  8/50 | train=0.6381 | val=0.6870 | 126.2s
[02:34:57]   Epoch  9/50 | train=0.6294 | val=0.6863 | 126.3s
[02:37:03]   Epoch 10/50 | train=0.6210 | val=0.6430 | 126.0s
[02:39:09]   Epoch 11/50 | train=0.6211 | val=0.5987 | 126.3s
[02:41:15]   Epoch 12/50 | train=0.6231 | val=0.6001 | 126.4s
[02:43:22]   Epoch 13/50 | train=0.6082 | val=0.6063 | 126.2s
[02:45:28]   Epoch 14/50 | train=0.6014 | val=0.5812 | 126.1s
[02:47:34]   Epoch 15/50 | train=0.6103 | val=0.5989 | 126.6s
[02:49:41]   Epoch 16/50 | train=0.6059 | val=0.5876 | 126.5s
[02:51:48]   Epoch 17/50 | train=0.5981 | val=0.5946 | 126.8s
[02:53:54]   Epoch 18/50 | train=0.5982 | val=0.6170 | 126.1s
[02:56:00]   Epoch 19/50 | train=0.5944 | val=0.5762 | 126.3s
[02:58:07]   Epoch 20/50 | train=0.5879 | val=0.6186 | 126.4s
[03:00:14]   Epoch 21/50 | train=0.5933 | val=0.5826 | 127.0s
[03:02:20]   Epoch 22/50 | train=0.5806 | val=0.6807 | 126.1s
[03:04:26]   Epoch 23/50 | train=0.5756 | val=0.5691 | 126.3s
[03:06:33]   Epoch 24/50 | train=0.5844 | val=0.5751 | 126.7s
[03:08:40]   Epoch 25/50 | train=0.5857 | val=0.5889 | 126.6s
[03:10:46]   Epoch 26/50 | train=0.5769 | val=0.6132 | 126.5s
[03:12:52]   Epoch 27/50 | train=0.5765 | val=0.5957 | 126.3s
[03:14:59]   Epoch 28/50 | train=0.5671 | val=0.6077 | 126.3s
[03:17:05]   Epoch 29/50 | train=0.5765 | val=0.6054 | 126.3s
[03:19:11]   Epoch 30/50 | train=0.5659 | val=0.5886 | 126.3s
[03:21:17]   Epoch 31/50 | train=0.5625 | val=0.6556 | 126.2s
[03:23:23]   Epoch 32/50 | train=0.5616 | val=0.5590 | 126.0s
[03:25:30]   Epoch 33/50 | train=0.5539 | val=0.5679 | 126.1s
[03:27:36]   Epoch 34/50 | train=0.5531 | val=0.5877 | 126.1s
[03:29:43]   Epoch 35/50 | train=0.5588 | val=0.5675 | 126.7s
[03:31:49]   Epoch 36/50 | train=0.5480 | val=0.5678 | 126.1s
[03:33:55]   Epoch 37/50 | train=0.5413 | val=0.6080 | 126.6s
[03:36:01]   Epoch 38/50 | train=0.5340 | val=0.5833 | 126.1s
[03:38:07]   Epoch 39/50 | train=0.5396 | val=0.5663 | 125.9s
[03:40:14]   Epoch 40/50 | train=0.5393 | val=0.5757 | 126.4s
[03:42:20]   Epoch 41/50 | train=0.5391 | val=0.5700 | 126.1s
[03:44:26]   Epoch 42/50 | train=0.5191 | val=0.5674 | 126.2s
[03:44:26]   Early stopping at epoch 42
[03:44:43]   Optimal threshold: 0.60 (val F1=0.869)
[03:44:50]   RESULTS: acc=0.976 | f1=0.988 | auc=nan | thresh=0.60
[03:44:50]            Sensitivity(MDD)=0.976 | Specificity(H)=0.000
[03:44:50]   Fold time: 90.3 min
[03:44:51] ======================================================================
[03:44:51] FOLD 29/40 — Test Subject: MDD_24
[03:44:51] ======================================================================
[03:46:04]   Sequences — Train: 4956, Val: 874, Test: 140
[03:46:04]   Class balance (train): H=1838, MDD=3118 | pos_weight=1.696
[03:46:04]   Data prep: 73.2s
[03:46:05]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[03:46:05]   Starting training...
[03:48:39]   Epoch  1/50 | train=0.8065 | val=0.7166 | 154.1s
[03:50:45]   Epoch  2/50 | train=0.7103 | val=0.6358 | 126.3s
[03:52:53]   Epoch  3/50 | train=0.6665 | val=0.6430 | 127.1s
[03:55:00]   Epoch  4/50 | train=0.6640 | val=0.6181 | 127.2s
[03:57:06]   Epoch  5/50 | train=0.6457 | val=0.6340 | 126.5s
[03:59:13]   Epoch  6/50 | train=0.6391 | val=0.7132 | 127.0s
[04:01:20]   Epoch  7/50 | train=0.6277 | val=0.6270 | 126.3s
[04:03:26]   Epoch  8/50 | train=0.6281 | val=0.6755 | 126.0s
[04:05:31]   Epoch  9/50 | train=0.6312 | val=0.6429 | 125.7s
[04:07:38]   Epoch 10/50 | train=0.6208 | val=0.6292 | 126.6s
[04:09:44]   Epoch 11/50 | train=0.6171 | val=0.6474 | 126.1s
[04:11:50]   Epoch 12/50 | train=0.6154 | val=0.6179 | 125.9s
[04:13:56]   Epoch 13/50 | train=0.6181 | val=0.6046 | 125.9s
[04:16:02]   Epoch 14/50 | train=0.6073 | val=0.6054 | 126.0s
[04:18:08]   Epoch 15/50 | train=0.6096 | val=0.5998 | 126.1s
[04:20:14]   Epoch 16/50 | train=0.6031 | val=0.5868 | 125.8s
[04:22:20]   Epoch 17/50 | train=0.5956 | val=0.5875 | 125.9s
[04:24:26]   Epoch 18/50 | train=0.5941 | val=0.6127 | 125.7s
[04:26:32]   Epoch 19/50 | train=0.5923 | val=0.5948 | 125.7s
[04:28:38]   Epoch 20/50 | train=0.5867 | val=0.6114 | 126.2s
[04:30:45]   Epoch 21/50 | train=0.5861 | val=0.5928 | 126.6s
[04:32:50]   Epoch 22/50 | train=0.5856 | val=0.6111 | 125.8s
[04:34:56]   Epoch 23/50 | train=0.5864 | val=0.6466 | 125.9s
[04:37:02]   Epoch 24/50 | train=0.5842 | val=0.5842 | 125.9s
[04:39:08]   Epoch 25/50 | train=0.5695 | val=0.6425 | 125.6s
[04:41:14]   Epoch 26/50 | train=0.5710 | val=0.5933 | 125.8s
[04:43:19]   Epoch 27/50 | train=0.5823 | val=0.5739 | 125.4s
[04:45:25]   Epoch 28/50 | train=0.5579 | val=0.6030 | 125.9s
[04:47:32]   Epoch 29/50 | train=0.5655 | val=0.6099 | 126.6s
[04:49:38]   Epoch 30/50 | train=0.5538 | val=0.6012 | 125.9s
[04:51:44]   Epoch 31/50 | train=0.5578 | val=0.6039 | 126.3s
[04:53:50]   Epoch 32/50 | train=0.5549 | val=0.6421 | 126.3s
[04:55:56]   Epoch 33/50 | train=0.5536 | val=0.5771 | 126.0s
[04:58:02]   Epoch 34/50 | train=0.5514 | val=0.5899 | 125.9s
[05:00:09]   Epoch 35/50 | train=0.5477 | val=0.6099 | 126.8s
[05:02:15]   Epoch 36/50 | train=0.5531 | val=0.6114 | 125.9s
[05:04:21]   Epoch 37/50 | train=0.5375 | val=0.6045 | 125.8s
[05:04:21]   Early stopping at epoch 37
[05:04:37]   Optimal threshold: 0.55 (val F1=0.861)
[05:04:40]   RESULTS: acc=0.993 | f1=0.996 | auc=nan | thresh=0.55
[05:04:40]            Sensitivity(MDD)=0.993 | Specificity(H)=0.000
[05:04:40]   Fold time: 79.8 min
[05:04:42] ======================================================================
[05:04:42] FOLD 30/40 — Test Subject: MDD_26
[05:04:42] ======================================================================
[05:06:45]   Sequences — Train: 4970, Val: 876, Test: 124
[05:06:45]   Class balance (train): H=1838, MDD=3132 | pos_weight=1.704
[05:06:45]   Data prep: 123.5s
[05:06:46]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[05:06:46]   Starting training...
[05:31:13]   Epoch  1/50 | train=0.8052 | val=0.7462 | 1467.1s
[06:05:49]   Epoch  2/50 | train=0.7122 | val=0.6799 | 2075.6s
[06:50:03]   Epoch  3/50 | train=0.6653 | val=0.6953 | 2653.9s
[07:40:41]   Epoch  4/50 | train=0.6488 | val=0.6626 | 3037.9s
[08:17:35]   Epoch  5/50 | train=0.6404 | val=0.6887 | 2213.8s
[08:19:24]   Epoch  6/50 | train=0.6321 | val=0.6659 | 109.2s
[08:21:12]   Epoch  7/50 | train=0.6293 | val=0.6942 | 107.8s
[08:23:02]   Epoch  8/50 | train=0.6192 | val=0.6418 | 110.6s
[08:24:59]   Epoch  9/50 | train=0.6136 | val=0.7097 | 116.6s
[08:26:56]   Epoch 10/50 | train=0.6123 | val=0.6650 | 117.4s
[08:28:55]   Epoch 11/50 | train=0.6159 | val=0.6534 | 118.4s
[08:30:54]   Epoch 12/50 | train=0.6057 | val=0.6516 | 118.9s
[08:32:53]   Epoch 13/50 | train=0.6125 | val=0.6333 | 119.4s
[08:34:53]   Epoch 14/50 | train=0.6047 | val=0.6900 | 119.9s
[08:36:53]   Epoch 15/50 | train=0.5991 | val=0.6737 | 120.2s
[08:38:54]   Epoch 16/50 | train=0.5977 | val=0.6597 | 120.7s
[08:40:55]   Epoch 17/50 | train=0.5947 | val=0.7204 | 120.8s
[08:42:56]   Epoch 18/50 | train=0.5876 | val=0.6409 | 120.8s
[08:44:57]   Epoch 19/50 | train=0.5980 | val=0.6355 | 121.2s
[08:46:58]   Epoch 20/50 | train=0.5846 | val=0.6515 | 121.2s
[08:49:00]   Epoch 21/50 | train=0.5933 | val=0.6756 | 121.8s
[08:51:02]   Epoch 22/50 | train=0.5713 | val=0.6423 | 122.0s
[08:53:03]   Epoch 23/50 | train=0.5773 | val=0.6443 | 121.5s
[08:53:03]   Early stopping at epoch 23
[08:53:19]   Optimal threshold: 0.65 (val F1=0.846)
[08:53:21]   RESULTS: acc=0.976 | f1=0.988 | auc=nan | thresh=0.65
[08:53:21]            Sensitivity(MDD)=0.976 | Specificity(H)=0.000
[08:53:21]   Fold time: 228.7 min
[08:53:23] ======================================================================
[08:53:23] FOLD 31/40 — Test Subject: MDD_27
[08:53:23] ======================================================================
[08:54:34]   Sequences — Train: 4990, Val: 880, Test: 100
[08:54:34]   Class balance (train): H=1838, MDD=3152 | pos_weight=1.715
[08:54:34]   Data prep: 71.6s
[08:54:35]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[08:54:35]   Starting training...
[08:57:00]   Epoch  1/50 | train=0.8084 | val=0.7483 | 144.9s
[08:59:03]   Epoch  2/50 | train=0.7233 | val=0.6195 | 123.0s
[09:01:06]   Epoch  3/50 | train=0.6777 | val=0.6356 | 122.7s
[09:03:08]   Epoch  4/50 | train=0.6718 | val=0.7097 | 122.9s
[09:05:18]   Epoch  5/50 | train=0.6544 | val=0.6002 | 129.5s
[09:07:31]   Epoch  6/50 | train=0.6523 | val=0.6764 | 133.4s
[09:09:42]   Epoch  7/50 | train=0.6390 | val=0.6418 | 130.5s
[09:11:50]   Epoch  8/50 | train=0.6263 | val=0.6226 | 128.3s
[09:13:59]   Epoch  9/50 | train=0.6315 | val=0.6243 | 129.1s
[09:16:12]   Epoch 10/50 | train=0.6269 | val=0.5878 | 132.2s
[09:18:20]   Epoch 11/50 | train=0.6195 | val=0.6292 | 127.9s
[09:20:28]   Epoch 12/50 | train=0.6149 | val=0.6390 | 128.2s
[09:22:37]   Epoch 13/50 | train=0.6005 | val=0.6624 | 128.8s
[09:24:46]   Epoch 14/50 | train=0.6032 | val=0.6589 | 129.7s
[09:26:59]   Epoch 15/50 | train=0.6125 | val=0.5790 | 132.3s
[09:29:11]   Epoch 16/50 | train=0.5982 | val=0.6104 | 132.0s
[09:31:22]   Epoch 17/50 | train=0.6005 | val=0.6018 | 131.1s
[09:33:33]   Epoch 18/50 | train=0.5897 | val=0.6086 | 131.6s
[09:35:46]   Epoch 19/50 | train=0.6024 | val=0.5936 | 133.2s
[09:37:57]   Epoch 20/50 | train=0.5920 | val=0.5851 | 130.4s
[09:40:10]   Epoch 21/50 | train=0.5861 | val=0.6046 | 133.1s
[09:42:25]   Epoch 22/50 | train=0.5858 | val=0.6166 | 134.9s
[09:44:37]   Epoch 23/50 | train=0.5816 | val=0.6925 | 132.5s
[09:46:50]   Epoch 24/50 | train=0.5815 | val=0.6172 | 133.1s
[09:49:04]   Epoch 25/50 | train=0.5725 | val=0.6102 | 133.4s
[09:49:04]   Early stopping at epoch 25
[09:49:21]   Optimal threshold: 0.55 (val F1=0.862)
[09:49:23]   RESULTS: acc=0.970 | f1=0.985 | auc=nan | thresh=0.55
[09:49:23]            Sensitivity(MDD)=0.970 | Specificity(H)=0.000
[09:49:23]   Fold time: 56.0 min
[09:49:24] ======================================================================
[09:49:24] FOLD 32/40 — Test Subject: MDD_28
[09:49:24] ======================================================================
[09:51:22]   Sequences — Train: 4931, Val: 869, Test: 170
[09:51:22]   Class balance (train): H=1838, MDD=3093 | pos_weight=1.683
[09:51:22]   Data prep: 117.4s
[09:51:23]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[09:51:23]   Starting training...
[09:53:34]   Epoch  1/50 | train=0.7932 | val=0.7768 | 131.8s
[09:55:45]   Epoch  2/50 | train=0.6994 | val=0.6618 | 130.9s
[09:58:00]   Epoch  3/50 | train=0.6590 | val=0.6735 | 134.5s
[10:00:12]   Epoch  4/50 | train=0.6493 | val=0.7437 | 132.5s
[10:02:25]   Epoch  5/50 | train=0.6463 | val=0.7655 | 132.6s
[10:04:35]   Epoch  6/50 | train=0.6352 | val=0.6490 | 130.4s
[10:06:49]   Epoch  7/50 | train=0.6349 | val=0.6414 | 133.9s
[10:08:57]   Epoch  8/50 | train=0.6271 | val=0.6615 | 128.0s
[10:11:03]   Epoch  9/50 | train=0.6287 | val=0.7069 | 126.0s
[10:13:08]   Epoch 10/50 | train=0.6205 | val=0.6196 | 124.5s
[10:15:12]   Epoch 11/50 | train=0.6128 | val=0.6539 | 124.3s
[10:17:17]   Epoch 12/50 | train=0.6080 | val=0.6549 | 124.7s
[10:19:22]   Epoch 13/50 | train=0.6047 | val=0.6746 | 125.5s
[10:21:28]   Epoch 14/50 | train=0.6023 | val=0.6235 | 125.9s
[10:23:32]   Epoch 15/50 | train=0.6025 | val=0.6040 | 123.9s
[10:25:35]   Epoch 16/50 | train=0.5937 | val=0.6158 | 122.7s
[10:27:38]   Epoch 17/50 | train=0.5928 | val=0.6301 | 123.3s
[10:29:42]   Epoch 18/50 | train=0.5883 | val=0.6279 | 123.4s
[10:31:45]   Epoch 19/50 | train=0.5893 | val=0.6215 | 123.5s
[10:33:49]   Epoch 20/50 | train=0.5955 | val=0.6097 | 123.6s
[10:35:52]   Epoch 21/50 | train=0.5781 | val=0.6354 | 123.3s
[10:37:55]   Epoch 22/50 | train=0.5894 | val=0.6264 | 123.1s
[10:39:59]   Epoch 23/50 | train=0.5768 | val=0.6900 | 123.8s
[10:42:03]   Epoch 24/50 | train=0.5825 | val=0.6500 | 124.0s
[10:44:06]   Epoch 25/50 | train=0.5829 | val=0.6144 | 123.3s
[10:44:06]   Early stopping at epoch 25
[10:44:23]   Optimal threshold: 0.60 (val F1=0.856)
[10:44:33]   RESULTS: acc=0.971 | f1=0.985 | auc=nan | thresh=0.60
[10:44:33]            Sensitivity(MDD)=0.971 | Specificity(H)=0.000
[10:44:33]   Fold time: 55.1 min
[10:44:34] ======================================================================
[10:44:34] FOLD 33/40 — Test Subject: MDD_29
[10:44:34] ======================================================================
[10:46:30]   Sequences — Train: 4953, Val: 873, Test: 144
[10:46:30]   Class balance (train): H=1838, MDD=3115 | pos_weight=1.695
[10:46:30]   Data prep: 115.9s
[10:47:24]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[10:47:24]   Starting training...
[10:49:53]   Epoch  1/50 | train=0.8073 | val=0.7283 | 148.6s
[10:51:53]   Epoch  2/50 | train=0.7153 | val=0.6494 | 120.2s
[10:54:01]   Epoch  3/50 | train=0.6748 | val=0.6346 | 128.2s
[10:56:06]   Epoch  4/50 | train=0.6527 | val=0.6258 | 124.5s
[10:58:11]   Epoch  5/50 | train=0.6470 | val=0.6280 | 124.6s
[11:00:15]   Epoch  6/50 | train=0.6295 | val=0.6307 | 124.6s
[11:02:20]   Epoch  7/50 | train=0.6469 | val=0.6342 | 125.1s
[11:04:26]   Epoch  8/50 | train=0.6373 | val=0.6128 | 125.2s
[11:06:30]   Epoch  9/50 | train=0.6189 | val=0.6355 | 124.7s
[11:08:36]   Epoch 10/50 | train=0.6237 | val=0.6505 | 125.9s
[11:10:41]   Epoch 11/50 | train=0.6119 | val=0.6634 | 124.7s
[11:12:46]   Epoch 12/50 | train=0.6054 | val=0.6100 | 125.1s
[11:14:51]   Epoch 13/50 | train=0.6118 | val=0.6452 | 125.0s
[11:16:57]   Epoch 14/50 | train=0.6189 | val=0.6077 | 125.9s
[11:19:05]   Epoch 15/50 | train=0.6155 | val=0.6426 | 127.9s
[11:21:10]   Epoch 16/50 | train=0.6050 | val=0.6027 | 124.9s
[11:23:15]   Epoch 17/50 | train=0.6078 | val=0.6086 | 124.3s
[11:25:19]   Epoch 18/50 | train=0.5913 | val=0.5964 | 124.3s
[11:27:23]   Epoch 19/50 | train=0.5886 | val=0.6160 | 124.2s
[11:29:28]   Epoch 20/50 | train=0.5831 | val=0.6213 | 124.5s
[11:31:32]   Epoch 21/50 | train=0.5921 | val=0.6009 | 124.1s
[11:33:36]   Epoch 22/50 | train=0.5873 | val=0.6002 | 123.8s
[11:35:40]   Epoch 23/50 | train=0.5886 | val=0.6120 | 124.2s
[11:37:45]   Epoch 24/50 | train=0.5741 | val=0.6073 | 124.9s
[11:39:49]   Epoch 25/50 | train=0.5779 | val=0.6098 | 124.5s
[11:41:54]   Epoch 26/50 | train=0.5663 | val=0.5833 | 124.2s
[11:43:58]   Epoch 27/50 | train=0.5790 | val=0.5911 | 124.1s
[11:46:02]   Epoch 28/50 | train=0.5693 | val=0.5827 | 124.0s
[11:48:06]   Epoch 29/50 | train=0.5724 | val=0.5856 | 124.0s
[11:50:11]   Epoch 30/50 | train=0.5633 | val=0.5968 | 125.2s
[11:52:16]   Epoch 31/50 | train=0.5535 | val=0.5914 | 124.5s
[11:54:21]   Epoch 32/50 | train=0.5535 | val=0.6193 | 125.6s
[11:56:26]   Epoch 33/50 | train=0.5645 | val=0.5953 | 125.1s
[11:58:31]   Epoch 34/50 | train=0.5502 | val=0.5713 | 124.6s
[12:00:36]   Epoch 35/50 | train=0.5531 | val=0.5954 | 124.9s
[12:02:40]   Epoch 36/50 | train=0.5550 | val=0.5763 | 124.4s
[12:04:45]   Epoch 37/50 | train=0.5587 | val=0.6355 | 124.8s
[12:06:50]   Epoch 38/50 | train=0.5422 | val=0.5970 | 125.3s
[12:08:55]   Epoch 39/50 | train=0.5472 | val=0.5972 | 124.7s
[12:11:00]   Epoch 40/50 | train=0.5406 | val=0.6066 | 124.6s
[12:13:04]   Epoch 41/50 | train=0.5504 | val=0.5802 | 124.6s
[12:15:09]   Epoch 42/50 | train=0.5309 | val=0.5860 | 125.1s
[12:17:14]   Epoch 43/50 | train=0.5318 | val=0.5788 | 124.8s
[12:19:18]   Epoch 44/50 | train=0.5277 | val=0.5952 | 124.0s
[12:19:18]   Early stopping at epoch 44
[12:19:35]   Optimal threshold: 0.65 (val F1=0.867)
[12:19:37]   RESULTS: acc=0.979 | f1=0.989 | auc=nan | thresh=0.65
[12:19:37]            Sensitivity(MDD)=0.979 | Specificity(H)=0.000
[12:19:37]   Fold time: 95.1 min
[12:19:39] ======================================================================
[12:19:39] FOLD 34/40 — Test Subject: MDD_3
[12:19:39] ======================================================================
[12:21:23]   Sequences — Train: 4983, Val: 879, Test: 108
[12:21:23]   Class balance (train): H=1838, MDD=3145 | pos_weight=1.711
[12:21:23]   Data prep: 104.6s
[12:21:24]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[12:21:24]   Starting training...
[12:23:43]   Epoch  1/50 | train=0.8064 | val=0.7292 | 138.4s
[12:25:49]   Epoch  2/50 | train=0.7093 | val=0.6412 | 125.9s
[12:27:57]   Epoch  3/50 | train=0.6650 | val=0.6423 | 128.0s
[12:30:03]   Epoch  4/50 | train=0.6566 | val=0.6692 | 126.4s
[12:32:10]   Epoch  5/50 | train=0.6486 | val=0.6226 | 126.5s
[12:34:16]   Epoch  6/50 | train=0.6465 | val=0.6259 | 126.1s
[12:36:22]   Epoch  7/50 | train=0.6369 | val=0.6343 | 126.3s
[12:38:28]   Epoch  8/50 | train=0.6311 | val=0.6582 | 126.0s
[12:40:35]   Epoch  9/50 | train=0.6240 | val=0.6795 | 126.5s
[12:42:41]   Epoch 10/50 | train=0.6204 | val=0.6359 | 126.3s
[12:44:47]   Epoch 11/50 | train=0.6231 | val=0.6414 | 126.2s
[12:46:54]   Epoch 12/50 | train=0.6126 | val=0.6296 | 126.6s
[12:49:01]   Epoch 13/50 | train=0.6137 | val=0.6174 | 127.2s
[12:51:07]   Epoch 14/50 | train=0.6080 | val=0.6316 | 126.4s
[12:53:14]   Epoch 15/50 | train=0.5933 | val=0.6383 | 126.5s
[12:55:21]   Epoch 16/50 | train=0.5990 | val=0.6272 | 127.0s
[12:57:27]   Epoch 17/50 | train=0.5918 | val=0.6520 | 126.3s
[12:59:33]   Epoch 18/50 | train=0.5852 | val=0.6350 | 126.2s
[13:01:40]   Epoch 19/50 | train=0.5936 | val=0.6354 | 126.1s
[13:03:46]   Epoch 20/50 | train=0.5865 | val=0.6184 | 126.4s
[13:05:52]   Epoch 21/50 | train=0.5827 | val=0.6565 | 126.1s
[13:07:59]   Epoch 22/50 | train=0.5888 | val=0.6643 | 127.1s
[13:10:06]   Epoch 23/50 | train=0.5766 | val=0.6374 | 127.0s
[13:10:06]   Early stopping at epoch 23
[13:10:23]   Optimal threshold: 0.55 (val F1=0.858)
[13:10:33]   RESULTS: acc=0.991 | f1=0.995 | auc=nan | thresh=0.55
[13:10:33]            Sensitivity(MDD)=0.991 | Specificity(H)=0.000
[13:10:33]   Fold time: 50.9 min
[13:10:34] ======================================================================
[13:10:34] FOLD 35/40 — Test Subject: MDD_30
[13:10:34] ======================================================================
[13:18:36]   Sequences — Train: 4939, Val: 871, Test: 160
[13:18:36]   Class balance (train): H=1838, MDD=3101 | pos_weight=1.687
[13:18:36]   Data prep: 481.8s
[13:18:36]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[13:18:36]   Starting training...
[13:21:10]   Epoch  1/50 | train=0.8118 | val=0.7342 | 154.2s
[13:23:07]   Epoch  2/50 | train=0.7304 | val=0.6574 | 116.5s
[13:25:16]   Epoch  3/50 | train=0.6777 | val=0.6637 | 128.7s
[13:27:20]   Epoch  4/50 | train=0.6619 | val=0.6214 | 124.2s
[13:29:24]   Epoch  5/50 | train=0.6591 | val=0.6129 | 124.3s
[13:31:29]   Epoch  6/50 | train=0.6349 | val=0.6935 | 124.6s
[13:33:34]   Epoch  7/50 | train=0.6335 | val=0.5962 | 124.7s
[13:35:39]   Epoch  8/50 | train=0.6436 | val=0.6239 | 124.8s
[13:37:44]   Epoch  9/50 | train=0.6227 | val=0.5886 | 125.0s
[13:39:49]   Epoch 10/50 | train=0.6212 | val=0.6221 | 125.2s
[13:41:54]   Epoch 11/50 | train=0.6315 | val=0.5965 | 125.2s
[13:43:59]   Epoch 12/50 | train=0.6106 | val=0.6110 | 125.2s
[13:46:05]   Epoch 13/50 | train=0.6132 | val=0.6207 | 125.4s
[13:48:11]   Epoch 14/50 | train=0.6050 | val=0.6272 | 125.7s
[13:50:18]   Epoch 15/50 | train=0.6110 | val=0.5912 | 127.0s
[13:52:23]   Epoch 16/50 | train=0.6027 | val=0.5877 | 125.7s
[13:54:29]   Epoch 17/50 | train=0.6014 | val=0.5846 | 125.5s
[13:56:34]   Epoch 18/50 | train=0.5934 | val=0.6119 | 125.5s
[13:58:40]   Epoch 19/50 | train=0.5905 | val=0.6417 | 125.5s
[14:00:45]   Epoch 20/50 | train=0.5963 | val=0.6294 | 125.3s
[14:02:51]   Epoch 21/50 | train=0.5838 | val=0.6015 | 125.5s
[14:04:56]   Epoch 22/50 | train=0.5929 | val=0.5864 | 125.0s
[14:07:01]   Epoch 23/50 | train=0.5880 | val=0.6215 | 125.5s
[14:09:07]   Epoch 24/50 | train=0.5754 | val=0.6015 | 126.1s
[14:11:13]   Epoch 25/50 | train=0.5759 | val=0.5875 | 125.8s
[14:13:19]   Epoch 26/50 | train=0.5830 | val=0.6198 | 125.9s
[14:15:25]   Epoch 27/50 | train=0.5750 | val=0.6121 | 126.3s
[14:15:25]   Early stopping at epoch 27
[14:15:42]   Optimal threshold: 0.45 (val F1=0.860)
[14:15:45]   RESULTS: acc=0.994 | f1=0.997 | auc=nan | thresh=0.45
[14:15:45]            Sensitivity(MDD)=0.994 | Specificity(H)=0.000
[14:15:45]   Fold time: 65.2 min
[14:15:46] ======================================================================
[14:15:46] FOLD 36/40 — Test Subject: MDD_31
[14:15:46] ======================================================================
[14:16:52]   Sequences — Train: 4928, Val: 869, Test: 173
[14:16:52]   Class balance (train): H=1838, MDD=3090 | pos_weight=1.681
[14:16:52]   Data prep: 65.2s
[14:16:52]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[14:16:52]   Starting training...
[14:19:06]   Epoch  1/50 | train=0.7907 | val=0.7069 | 133.8s
[14:21:12]   Epoch  2/50 | train=0.7121 | val=0.6188 | 125.9s
[14:23:23]   Epoch  3/50 | train=0.6714 | val=0.6637 | 131.1s
[14:25:30]   Epoch  4/50 | train=0.6544 | val=0.5953 | 126.6s
[14:27:37]   Epoch  5/50 | train=0.6476 | val=0.5796 | 126.8s
[14:29:43]   Epoch  6/50 | train=0.6447 | val=0.5666 | 126.3s
[14:31:49]   Epoch  7/50 | train=0.6397 | val=0.5640 | 125.9s
[14:33:55]   Epoch  8/50 | train=0.6247 | val=0.5779 | 125.8s
[14:36:01]   Epoch  9/50 | train=0.6302 | val=0.6393 | 126.0s
[14:38:06]   Epoch 10/50 | train=0.6251 | val=0.5640 | 125.5s
[14:40:11]   Epoch 11/50 | train=0.6200 | val=0.5763 | 125.0s
[14:42:17]   Epoch 12/50 | train=0.6277 | val=0.5614 | 125.3s
[14:44:23]   Epoch 13/50 | train=0.6268 | val=0.5881 | 125.8s
[14:46:28]   Epoch 14/50 | train=0.6080 | val=0.6266 | 125.6s
[14:48:35]   Epoch 15/50 | train=0.6174 | val=0.5917 | 126.6s
[14:50:41]   Epoch 16/50 | train=0.6017 | val=0.5638 | 126.7s
[14:52:47]   Epoch 17/50 | train=0.6070 | val=0.5502 | 125.8s
[14:54:53]   Epoch 18/50 | train=0.5949 | val=0.5520 | 125.9s
[14:56:59]   Epoch 19/50 | train=0.5937 | val=0.5530 | 125.9s
[14:59:05]   Epoch 20/50 | train=0.5945 | val=0.5428 | 126.0s
[15:01:12]   Epoch 21/50 | train=0.5928 | val=0.5632 | 126.3s
[15:03:17]   Epoch 22/50 | train=0.5846 | val=0.5747 | 125.8s
[15:05:23]   Epoch 23/50 | train=0.5862 | val=0.5451 | 126.0s
[15:07:30]   Epoch 24/50 | train=0.5888 | val=0.6037 | 126.6s
[15:09:36]   Epoch 25/50 | train=0.5844 | val=0.5773 | 125.7s
[15:11:41]   Epoch 26/50 | train=0.5739 | val=0.5726 | 125.5s
[15:13:47]   Epoch 27/50 | train=0.5724 | val=0.5756 | 125.9s
[15:15:53]   Epoch 28/50 | train=0.5694 | val=0.5659 | 126.1s
[15:18:00]   Epoch 29/50 | train=0.5718 | val=0.5482 | 126.4s
[15:20:06]   Epoch 30/50 | train=0.5673 | val=0.5507 | 126.0s
[15:20:06]   Early stopping at epoch 30
[15:20:22]   Optimal threshold: 0.65 (val F1=0.871)
[15:20:36]   RESULTS: acc=1.000 | f1=1.000 | auc=nan | thresh=0.65
[15:20:36]            Sensitivity(MDD)=1.000 | Specificity(H)=0.000
[15:20:36]   Fold time: 64.8 min
[15:20:37] ======================================================================
[15:20:37] FOLD 37/40 — Test Subject: MDD_32
[15:20:37] ======================================================================
[15:21:45]   Sequences — Train: 4930, Val: 869, Test: 171
[15:21:45]   Class balance (train): H=1838, MDD=3092 | pos_weight=1.682
[15:21:45]   Data prep: 67.8s
[15:21:45]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[15:21:45]   Starting training...
[15:24:04]   Epoch  1/50 | train=0.8021 | val=0.7227 | 139.0s
[15:26:13]   Epoch  2/50 | train=0.6998 | val=0.6132 | 128.4s
[15:28:24]   Epoch  3/50 | train=0.6704 | val=0.6227 | 131.0s
[15:30:31]   Epoch  4/50 | train=0.6631 | val=0.6868 | 126.9s
[15:32:38]   Epoch  5/50 | train=0.6491 | val=0.6046 | 127.1s
[15:34:44]   Epoch  6/50 | train=0.6439 | val=0.6286 | 126.5s
[15:36:51]   Epoch  7/50 | train=0.6342 | val=0.6775 | 126.4s
[15:38:57]   Epoch  8/50 | train=0.6339 | val=0.6356 | 126.6s
[15:41:04]   Epoch  9/50 | train=0.6185 | val=0.6111 | 126.1s
[15:43:10]   Epoch 10/50 | train=0.6166 | val=0.6223 | 126.2s
[15:45:16]   Epoch 11/50 | train=0.6229 | val=0.6133 | 126.0s
[15:47:22]   Epoch 12/50 | train=0.6170 | val=0.5973 | 126.3s
[15:49:29]   Epoch 13/50 | train=0.6138 | val=0.5753 | 126.6s
[15:51:35]   Epoch 14/50 | train=0.6091 | val=0.6302 | 126.2s
[15:53:42]   Epoch 15/50 | train=0.6161 | val=0.6043 | 127.0s
[15:55:48]   Epoch 16/50 | train=0.5986 | val=0.6277 | 126.2s
[15:57:54]   Epoch 17/50 | train=0.5941 | val=0.6299 | 125.7s
[15:59:59]   Epoch 18/50 | train=0.5954 | val=0.6401 | 125.2s
[16:02:04]   Epoch 19/50 | train=0.5920 | val=0.6498 | 125.2s
[16:04:10]   Epoch 20/50 | train=0.5978 | val=0.5951 | 125.6s
[16:06:16]   Epoch 21/50 | train=0.5874 | val=0.6783 | 126.1s
[16:08:22]   Epoch 22/50 | train=0.5790 | val=0.6180 | 126.1s
[16:10:28]   Epoch 23/50 | train=0.5955 | val=0.5674 | 125.5s
[16:12:33]   Epoch 24/50 | train=0.5748 | val=0.6081 | 125.6s
[16:14:39]   Epoch 25/50 | train=0.5773 | val=0.6493 | 125.9s
[16:16:45]   Epoch 26/50 | train=0.5696 | val=0.5965 | 125.9s
[16:18:52]   Epoch 27/50 | train=0.5759 | val=0.5728 | 126.5s
[16:20:57]   Epoch 28/50 | train=0.5655 | val=0.5882 | 125.6s
[16:23:04]   Epoch 29/50 | train=0.5625 | val=0.5755 | 126.3s
[16:25:09]   Epoch 30/50 | train=0.5623 | val=0.5866 | 125.8s
[16:27:15]   Epoch 31/50 | train=0.5618 | val=0.5855 | 125.7s
[16:29:21]   Epoch 32/50 | train=0.5621 | val=0.6217 | 126.0s
[16:31:28]   Epoch 33/50 | train=0.5577 | val=0.6053 | 126.4s
[16:31:28]   Early stopping at epoch 33
[16:31:44]   Optimal threshold: 0.55 (val F1=0.867)
[16:31:49]   RESULTS: acc=0.977 | f1=0.988 | auc=nan | thresh=0.55
[16:31:49]            Sensitivity(MDD)=0.977 | Specificity(H)=0.000
[16:31:49]   Fold time: 71.2 min
[16:31:51] ======================================================================
[16:31:51] FOLD 38/40 — Test Subject: MDD_33
[16:31:51] ======================================================================
[16:32:57]   Sequences — Train: 4944, Val: 872, Test: 154
[16:32:57]   Class balance (train): H=1838, MDD=3106 | pos_weight=1.690
[16:32:57]   Data prep: 65.9s
[16:32:57]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[16:32:57]   Starting training...
[16:35:11]   Epoch  1/50 | train=0.7981 | val=0.6924 | 134.1s
[16:37:19]   Epoch  2/50 | train=0.7089 | val=0.6204 | 127.6s
[16:39:33]   Epoch  3/50 | train=0.6657 | val=0.6195 | 133.9s
[16:41:43]   Epoch  4/50 | train=0.6526 | val=0.6079 | 129.8s
[16:43:51]   Epoch  5/50 | train=0.6406 | val=0.6223 | 128.1s
[16:45:58]   Epoch  6/50 | train=0.6345 | val=0.6819 | 126.9s
[16:48:05]   Epoch  7/50 | train=0.6432 | val=0.6097 | 126.5s
[16:50:12]   Epoch  8/50 | train=0.6370 | val=0.6492 | 127.4s
[16:52:18]   Epoch  9/50 | train=0.6243 | val=0.7366 | 126.6s
[16:54:25]   Epoch 10/50 | train=0.6191 | val=0.6287 | 126.5s
[16:56:31]   Epoch 11/50 | train=0.6106 | val=0.6571 | 126.5s
[16:58:38]   Epoch 12/50 | train=0.6153 | val=0.6015 | 126.2s
[17:00:44]   Epoch 13/50 | train=0.6076 | val=0.6089 | 126.5s
[17:02:51]   Epoch 14/50 | train=0.6131 | val=0.6270 | 126.3s
[17:04:58]   Epoch 15/50 | train=0.6023 | val=0.6414 | 126.9s
[17:07:05]   Epoch 16/50 | train=0.5981 | val=0.6247 | 127.8s
[17:09:12]   Epoch 17/50 | train=0.6217 | val=0.6009 | 126.8s
[17:11:19]   Epoch 18/50 | train=0.5966 | val=0.5968 | 126.9s
[17:13:26]   Epoch 19/50 | train=0.5869 | val=0.6007 | 126.7s
[17:15:33]   Epoch 20/50 | train=0.5883 | val=0.6700 | 126.5s
[17:17:39]   Epoch 21/50 | train=0.5952 | val=0.5835 | 126.8s
[17:19:46]   Epoch 22/50 | train=0.5904 | val=0.6044 | 126.6s
[17:21:53]   Epoch 23/50 | train=0.5805 | val=0.6010 | 126.6s
[17:23:59]   Epoch 24/50 | train=0.5783 | val=0.5864 | 126.6s
[17:26:06]   Epoch 25/50 | train=0.5742 | val=0.5993 | 126.5s
[17:28:13]   Epoch 26/50 | train=0.5704 | val=0.6071 | 127.3s
[17:30:23]   Epoch 27/50 | train=0.5640 | val=0.6074 | 129.7s
[17:32:31]   Epoch 28/50 | train=0.5717 | val=0.6094 | 128.2s
[17:34:37]   Epoch 29/50 | train=0.5604 | val=0.6203 | 126.4s
[17:36:44]   Epoch 30/50 | train=0.5551 | val=0.6249 | 126.9s
[17:38:51]   Epoch 31/50 | train=0.5586 | val=0.5950 | 126.9s
[17:38:51]   Early stopping at epoch 31
[17:39:08]   Optimal threshold: 0.65 (val F1=0.858)
[17:39:16]   RESULTS: acc=0.968 | f1=0.983 | auc=nan | thresh=0.65
[17:39:16]            Sensitivity(MDD)=0.968 | Specificity(H)=0.000
[17:39:16]   Fold time: 67.4 min
[17:39:17] ======================================================================
[17:39:17] FOLD 39/40 — Test Subject: MDD_5
[17:39:17] ======================================================================
[17:40:24]   Sequences — Train: 4941, Val: 871, Test: 158
[17:40:24]   Class balance (train): H=1838, MDD=3103 | pos_weight=1.688
[17:40:24]   Data prep: 66.7s
[17:40:24]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[17:40:24]   Starting training...
[17:42:54]   Epoch  1/50 | train=0.7990 | val=0.6525 | 150.0s
[17:44:58]   Epoch  2/50 | train=0.6776 | val=0.6308 | 123.3s
[17:47:03]   Epoch  3/50 | train=0.6284 | val=0.5648 | 125.3s
[17:49:13]   Epoch  4/50 | train=0.6158 | val=0.6007 | 130.0s
[17:51:23]   Epoch  5/50 | train=0.6078 | val=0.6157 | 129.4s
[17:53:31]   Epoch  6/50 | train=0.6054 | val=0.6600 | 128.1s
[17:55:39]   Epoch  7/50 | train=0.5857 | val=0.5389 | 128.0s
[17:57:46]   Epoch  8/50 | train=0.5801 | val=0.5188 | 127.4s
[17:59:54]   Epoch  9/50 | train=0.5766 | val=0.5342 | 127.5s
[18:02:02]   Epoch 10/50 | train=0.5686 | val=0.6440 | 127.7s
[18:04:09]   Epoch 11/50 | train=0.5797 | val=0.5853 | 127.2s
[18:06:17]   Epoch 12/50 | train=0.5780 | val=0.5549 | 127.8s
[18:08:25]   Epoch 13/50 | train=0.5531 | val=0.6203 | 128.0s
[18:10:32]   Epoch 14/50 | train=0.5500 | val=0.5602 | 127.1s
[18:12:39]   Epoch 15/50 | train=0.5507 | val=0.5931 | 127.1s
[18:14:46]   Epoch 16/50 | train=0.5533 | val=0.5823 | 127.2s
[18:16:53]   Epoch 17/50 | train=0.5506 | val=0.5734 | 127.2s
[18:19:01]   Epoch 18/50 | train=0.5437 | val=0.6586 | 127.7s
[18:19:01]   Early stopping at epoch 18
[18:19:18]   Optimal threshold: 0.70 (val F1=0.889)
[18:19:35]   RESULTS: acc=0.063 | f1=0.119 | auc=nan | thresh=0.70
[18:19:35]            Sensitivity(MDD)=0.063 | Specificity(H)=0.000
[18:19:35]   Fold time: 40.3 min
[18:19:36] ======================================================================
[18:19:36] FOLD 40/40 — Test Subject: MDD_6
[18:19:36] ======================================================================
[18:20:45]   Sequences — Train: 4958, Val: 874, Test: 138
[18:20:45]   Class balance (train): H=1838, MDD=3120 | pos_weight=1.697
[18:20:45]   Data prep: 69.4s
[18:20:46]   Model: InceptionV3+LSTM(seq=10) | Trainable: 1,115,265/22,900,833
[18:20:46]   Starting training...
[18:23:25]   Epoch  1/50 | train=0.8070 | val=0.7340 | 159.5s
[18:25:39]   Epoch  2/50 | train=0.7040 | val=0.6564 | 133.5s
[18:27:58]   Epoch  3/50 | train=0.6734 | val=0.6259 | 138.9s
[18:30:18]   Epoch  4/50 | train=0.6630 | val=0.6461 | 140.2s
[18:32:38]   Epoch  5/50 | train=0.6439 | val=0.6333 | 140.0s
[18:34:58]   Epoch  6/50 | train=0.6398 | val=0.6033 | 140.0s
[18:37:16]   Epoch  7/50 | train=0.6340 | val=0.6723 | 138.2s
[18:39:42]   Epoch  8/50 | train=0.6328 | val=0.6503 | 145.4s
[18:41:58]   Epoch  9/50 | train=0.6327 | val=0.7253 | 136.7s
[18:44:14]   Epoch 10/50 | train=0.6269 | val=0.6302 | 136.0s
[18:46:25]   Epoch 11/50 | train=0.6241 | val=0.5954 | 130.8s
[18:48:33]   Epoch 12/50 | train=0.6182 | val=0.7344 | 127.9s
[18:50:42]   Epoch 13/50 | train=0.6133 | val=0.6896 | 128.6s
[18:52:50]   Epoch 14/50 | train=0.6149 | val=0.6009 | 127.9s
[18:54:58]   Epoch 15/50 | train=0.6059 | val=0.6271 | 127.8s
[18:57:08]   Epoch 16/50 | train=0.6102 | val=0.6403 | 130.6s
[18:59:20]   Epoch 17/50 | train=0.6051 | val=0.6097 | 131.5s
[19:01:30]   Epoch 18/50 | train=0.6009 | val=0.6266 | 130.0s
[19:03:36]   Epoch 19/50 | train=0.5992 | val=0.6627 | 126.5s
[19:05:43]   Epoch 20/50 | train=0.5943 | val=0.6245 | 126.7s
[19:07:50]   Epoch 21/50 | train=0.5968 | val=0.6024 | 127.6s
[19:07:50]   Early stopping at epoch 21
[19:08:07]   Optimal threshold: 0.60 (val F1=0.863)
[19:08:10]   RESULTS: acc=0.978 | f1=0.989 | auc=nan | thresh=0.60
[19:08:10]            Sensitivity(MDD)=0.978 | Specificity(H)=0.000
[19:08:10]   Fold time: 48.6 min
[19:08:11] ======================================================================
[19:08:11] FINAL RESULTS
[19:08:11] ======================================================================
[19:08:11]   Global Confusion Matrix:
[[1375  787]
 [ 377 3431]]
[19:08:11] 
+---------+-------+-------+-------------+-------------+-----+--------+
| Subject |  Acc  |   F1  | Sensitivity | Specificity | AUC | Thresh |
+---------+-------+-------+-------------+-------------+-----+--------+
|   H_14  | 0.669 | 0.000 |    0.000    |    0.669    | nan |  0.55  |
|   H_16  | 0.020 | 0.000 |    0.000    |    0.020    | nan |  0.55  |
|   H_19  | 0.935 | 0.000 |    0.000    |    0.935    | nan |  0.75  |
|   H_22  | 0.837 | 0.000 |    0.000    |    0.837    | nan |  0.75  |
|   H_23  | 0.793 | 0.000 |    0.000    |    0.793    | nan |  0.55  |
|   H_24  | 0.000 | 0.000 |    0.000    |    0.000    | nan |  0.70  |
|   H_26  | 0.689 | 0.000 |    0.000    |    0.689    | nan |  0.65  |
|   H_27  | 0.000 | 0.000 |    0.000    |    0.000    | nan |  0.70  |
|   H_28  | 0.915 | 0.000 |    0.000    |    0.915    | nan |  0.55  |
|   H_4   | 0.719 | 0.000 |    0.000    |    0.719    | nan |  0.55  |
|   H_5   | 0.906 | 0.000 |    0.000    |    0.906    | nan |  0.80  |
|   H_6   | 0.890 | 0.000 |    0.000    |    0.890    | nan |  0.75  |
|   H_8   | 0.774 | 0.000 |    0.000    |    0.774    | nan |  0.65  |
|   H_9   | 0.826 | 0.000 |    0.000    |    0.826    | nan |  0.55  |
|  MDD_1  | 0.982 | 0.991 |    0.982    |    0.000    | nan |  0.60  |
|  MDD_10 | 0.977 | 0.988 |    0.977    |    0.000    | nan |  0.55  |
|  MDD_11 | 1.000 | 1.000 |    1.000    |    0.000    | nan |  0.60  |
|  MDD_13 | 0.949 | 0.974 |    0.949    |    0.000    | nan |  0.65  |
|  MDD_14 | 0.958 | 0.979 |    0.958    |    0.000    | nan |  0.55  |
|  MDD_15 | 0.994 | 0.997 |    0.994    |    0.000    | nan |  0.45  |
|  MDD_17 | 0.977 | 0.988 |    0.977    |    0.000    | nan |  0.45  |
|  MDD_18 | 0.950 | 0.975 |    0.950    |    0.000    | nan |  0.65  |
|  MDD_19 | 0.165 | 0.283 |    0.165    |    0.000    | nan |  0.75  |
|  MDD_2  | 0.947 | 0.973 |    0.947    |    0.000    | nan |  0.60  |
|  MDD_20 | 0.988 | 0.994 |    0.988    |    0.000    | nan |  0.40  |
|  MDD_21 | 0.936 | 0.967 |    0.936    |    0.000    | nan |  0.45  |
|  MDD_22 | 0.959 | 0.979 |    0.959    |    0.000    | nan |  0.70  |
|  MDD_23 | 0.976 | 0.988 |    0.976    |    0.000    | nan |  0.60  |
|  MDD_24 | 0.993 | 0.996 |    0.993    |    0.000    | nan |  0.55  |
|  MDD_26 | 0.976 | 0.988 |    0.976    |    0.000    | nan |  0.65  |
|  MDD_27 | 0.970 | 0.985 |    0.970    |    0.000    | nan |  0.55  |
|  MDD_28 | 0.971 | 0.985 |    0.971    |    0.000    | nan |  0.60  |
|  MDD_29 | 0.979 | 0.989 |    0.979    |    0.000    | nan |  0.65  |
|  MDD_3  | 0.991 | 0.995 |    0.991    |    0.000    | nan |  0.55  |
|  MDD_30 | 0.994 | 0.997 |    0.994    |    0.000    | nan |  0.45  |
|  MDD_31 | 1.000 | 1.000 |    1.000    |    0.000    | nan |  0.65  |
|  MDD_32 | 0.977 | 0.988 |    0.977    |    0.000    | nan |  0.55  |
|  MDD_33 | 0.968 | 0.983 |    0.968    |    0.000    | nan |  0.65  |
|  MDD_5  | 0.063 | 0.119 |    0.063    |    0.000    | nan |  0.70  |
|  MDD_6  | 0.978 | 0.989 |    0.978    |    0.000    | nan |  0.60  |
+---------+-------+-------+-------------+-------------+-----+--------+
[19:08:11] 
+-------------+-------+-------+-------+-------+
|    Metric   |  Mean |  Std  |  Min  |  Max  |
+-------------+-------+-------+-------+-------+
|   Accuracy  | 0.815 | 0.302 | 0.000 | 1.000 |
|      F1     | 0.602 | 0.474 | 0.000 | 1.000 |
| Sensitivity | 0.590 | 0.471 | 0.000 | 1.000 |
| Specificity | 0.224 | 0.366 | 0.000 | 0.935 |
+-------------+-------+-------+-------+-------+
[19:08:11] 
  GLOBAL (aggregated across all folds):
[19:08:11]     Accuracy:    0.805
[19:08:11]     Sensitivity: 0.901
[19:08:11]     Specificity: 0.636
[19:08:11]     F1 Score:    0.855
[19:08:11] 
  Results saved to: /Users/abhinavjoshi/Downloads/eeg_depression/results/exp1_seq_lstm
[19:08:11]   Total time: 2879.9 minutes
